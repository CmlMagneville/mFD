<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Plot functional space quality with a chosen quality metric — quality.fspaces.plot • mFD</title><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Plot functional space quality with a chosen quality metric — quality.fspaces.plot"><meta name="description" content="Plot functional space quality with a chosen quality metric"><meta property="og:description" content="Plot functional space quality with a chosen quality metric"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">mFD</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.7.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/mFD_general_workflow.html">mFD: General Workflow</a></li>
    <li><a class="dropdown-item" href="../articles/Compute_and_interpret_quality_of_functional_spaces.html">Compute and Interpret Quality of Functional Spaces</a></li>
    <li><a class="dropdown-item" href="../articles/Continuous_traits_framework.html">Continuous Traits Framework</a></li>
    <li><a class="dropdown-item" href="../articles/How_to_deal_with_Functional_Entities.html">How to Deal With Functional Entities</a></li>
    <li><a class="dropdown-item" href="../articles/Compute_functional_hill_indices.html">Compute Functional Diversity Hill Indices</a></li>
    <li><a class="dropdown-item" href="../articles/Customised_plots.html">Customised plots</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/CmlMagneville/mFD/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Plot functional space quality with a chosen quality metric</h1>
      <small class="dont-index">Source: <a href="https://github.com/CmlMagneville/mFD/blob/main/R/plot_quality_fspaces.R" class="external-link"><code>R/plot_quality_fspaces.R</code></a></small>
      <div class="d-none name"><code>quality.fspaces.plot.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Plot functional space quality with a chosen quality metric</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">quality.fspaces.plot</span><span class="op">(</span></span>
<span>  <span class="va">fspaces_quality</span>,</span>
<span>  <span class="va">quality_metric</span>,</span>
<span>  <span class="va">fspaces_plot</span>,</span>
<span>  name_file <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  range_dist <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  range_dev <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  range_qdev <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  gradient_deviation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>neg <span class="op">=</span> <span class="st">"darkblue"</span>, nul <span class="op">=</span> <span class="st">"grey80"</span>, pos <span class="op">=</span> <span class="st">"darkred"</span><span class="op">)</span>,</span>
<span>  gradient_deviation_quality <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>low <span class="op">=</span> <span class="st">"yellow"</span>, high <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span>,</span>
<span>  x_lab <span class="op">=</span> <span class="st">"Trait-based distance"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-fspaces-quality">fspaces_quality<a class="anchor" aria-label="anchor" href="#arg-fspaces-quality"></a></dt>
<dd><p>output from the <code><a href="quality.fspaces.html">quality.fspaces</a></code>
function, that is a list with all data needed to illustrate quality of
functional spaces based on deviation between species trait-based distance
and distance in functional spaces built using PCoA (and dendrogram).</p></dd>


<dt id="arg-quality-metric">quality_metric<a class="anchor" aria-label="anchor" href="#arg-quality-metric"></a></dt>
<dd><p>a character string with the name of the quality metric
to illustrate. Should be one of the column names of
<code>fspaces_quality$quality_fspaces</code>. See help of
<code><a href="quality.fspaces.html">quality.fspaces</a></code> for the meaning of these names regarding
type of deviation and scaling of distance in functional space. Default:
<code>'mad'</code> (Mean absolute deviation).</p></dd>


<dt id="arg-fspaces-plot">fspaces_plot<a class="anchor" aria-label="anchor" href="#arg-fspaces-plot"></a></dt>
<dd><p>a vector with names of functional spaces to consider.
Should be a subset of the row names of
<code>quality_fspaces$quality_fspaces</code>. Maximum of 10 spaces allowed to
keep decent plot size.</p></dd>


<dt id="arg-name-file">name_file<a class="anchor" aria-label="anchor" href="#arg-name-file"></a></dt>
<dd><p>a character string with name of file to save the
figure (without extension). Default: <code>NULL</code> which means plot is displayed.</p></dd>


<dt id="arg-range-dist">range_dist<a class="anchor" aria-label="anchor" href="#arg-range-dist"></a></dt>
<dd><p>a vector with minimum and maximum values to
display for species pairwise distances (x-axis for all panels and y-axes
of top panel). Default: NULL, which means range is 0 to maximum distance
among all the functional spaces to plot.</p></dd>


<dt id="arg-range-dev">range_dev<a class="anchor" aria-label="anchor" href="#arg-range-dev"></a></dt>
<dd><p>a vector with minimum and maximum values to display
for deviation to trait-based distance (y-axis of middle panel). Default:
NULL, which means range is set to range of deviation among all the
functional spaces to plot.</p></dd>


<dt id="arg-range-qdev">range_qdev<a class="anchor" aria-label="anchor" href="#arg-range-qdev"></a></dt>
<dd><p>a vector with minimum and maximum values to
display for deviation to trait-based distance (y-axis of bottom panel).
Default:NULL, which means range is from 0 to the maximum of (transformed)
deviation among all the functional spaces to plot.</p></dd>


<dt id="arg-gradient-deviation">gradient_deviation<a class="anchor" aria-label="anchor" href="#arg-gradient-deviation"></a></dt>
<dd><p>a vector of 3 colors for illustrating raw
deviation with <code><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">scale_colour_gradient2</a></code>. The first
value ('neg') is for the lowest negative deviation, the second value
('nul')is for null deviation and the third value ('pos') is for the
highest positive deviation. Default gradient is from darkblue to grey to
red.</p></dd>


<dt id="arg-gradient-deviation-quality">gradient_deviation_quality<a class="anchor" aria-label="anchor" href="#arg-gradient-deviation-quality"></a></dt>
<dd><p>2 colors (named 'low' and 'high') for
illustrating transformed deviation used to compute quality metric with
<code><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">scale_colour_gradient2</a></code> (default gradient is from
yellow to red).</p></dd>


<dt id="arg-x-lab">x_lab<a class="anchor" aria-label="anchor" href="#arg-x-lab"></a></dt>
<dd><p>a character string with title to display below X axis.
Default is 'Trait-based distance'.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A png file (resolution 300dpi) saved in the current working
directory. Quality of each functional space is illustrated with three
panels : - top row shows trait-based distance between species vs.
space-based distance. - middle row shows trait-based distance vs.
deviation between space-based and trait-based distances - bottom row shows
trait-based distance between species vs. transformed deviation used to
compute the quality metric All plots have the same X axis. All plots on a
given row have the same Y axis and color palette. Type of distance in
functional space (Euclidean in PCoA, Cophenetic on tree) are abbreviated,
as well as type of transformation of distance (scaling) and of deviation
(Absolute or Squared)</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Sebastien Villeger and Camille Magneville</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Load Species*Traits dataframe:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"fruits_traits"</span>, package <span class="op">=</span> <span class="st">"mFD"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Load Assemblages*Species dataframe:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"baskets_fruits_weights"</span>, package <span class="op">=</span> <span class="st">"mFD"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Load Traits categories dataframe:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"fruits_traits_cat"</span>, package <span class="op">=</span> <span class="st">"mFD"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Compute functional distance</span></span></span>
<span class="r-in"><span><span class="va">sp_dist_fruits</span> <span class="op">&lt;-</span> <span class="fu">mFD</span><span class="fu">::</span><span class="fu"><a href="funct.dist.html">funct.dist</a></span><span class="op">(</span>sp_tr         <span class="op">=</span> <span class="va">fruits_traits</span>,</span></span>
<span class="r-in"><span>                                  tr_cat        <span class="op">=</span> <span class="va">fruits_traits_cat</span>,</span></span>
<span class="r-in"><span>                                  metric        <span class="op">=</span> <span class="st">"gower"</span>,</span></span>
<span class="r-in"><span>                                  scale_euclid  <span class="op">=</span> <span class="st">"scale_center"</span>,</span></span>
<span class="r-in"><span>                                  ordinal_var   <span class="op">=</span> <span class="st">"classic"</span>,</span></span>
<span class="r-in"><span>                                  weight_type   <span class="op">=</span> <span class="st">"equal"</span>,</span></span>
<span class="r-in"><span>                                  stop_if_NA    <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Running w.type=equal on groups=c(Size)"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Running w.type=equal on groups=c(Plant)"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Running w.type=equal on groups=c(Climate)"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Running w.type=equal on groups=c(Seed)"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Running w.type=equal on groups=c(Sugar)"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Running w.type=equal on groups=c(Use,Use,Use)"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Compute functional spaces quality to retrieve species coordinates matrix:</span></span></span>
<span class="r-in"><span><span class="va">fspaces_quality_fruits</span> <span class="op">&lt;-</span> <span class="fu">mFD</span><span class="fu">::</span><span class="fu"><a href="quality.fspaces.html">quality.fspaces</a></span><span class="op">(</span></span></span>
<span class="r-in"><span> sp_dist             <span class="op">=</span> <span class="va">sp_dist_fruits</span>,</span></span>
<span class="r-in"><span> maxdim_pcoa         <span class="op">=</span> <span class="fl">10</span>,</span></span>
<span class="r-in"><span> deviation_weighting <span class="op">=</span> <span class="st">"absolute"</span>,</span></span>
<span class="r-in"><span> fdist_scaling       <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span> fdendro             <span class="op">=</span> <span class="st">"average"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="co"># Illustrate the quality of functional spaces:</span></span></span>
<span class="r-in"><span> <span class="fu">mFD</span><span class="fu">::</span><span class="fu">quality.fspaces.plot</span><span class="op">(</span></span></span>
<span class="r-in"><span>  fspaces_quality            <span class="op">=</span> <span class="va">fspaces_quality_fruits</span>,</span></span>
<span class="r-in"><span>  quality_metric             <span class="op">=</span> <span class="st">"mad"</span>,</span></span>
<span class="r-in"><span>  fspaces_plot               <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"tree_average"</span>, <span class="st">"pcoa_2d"</span>, <span class="st">"pcoa_3d"</span>, </span></span>
<span class="r-in"><span>                              <span class="st">"pcoa_4d"</span>, <span class="st">"pcoa_5d"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  name_file                  <span class="op">=</span> <span class="cn">NULL</span>, </span></span>
<span class="r-in"><span>  range_dist                 <span class="op">=</span> <span class="cn">NULL</span>, </span></span>
<span class="r-in"><span>  range_dev                  <span class="op">=</span> <span class="cn">NULL</span>, </span></span>
<span class="r-in"><span>  range_qdev                 <span class="op">=</span> <span class="cn">NULL</span>,</span></span>
<span class="r-in"><span>  gradient_deviation         <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>neg <span class="op">=</span> <span class="st">"darkblue"</span>, nul <span class="op">=</span> <span class="st">"grey80"</span>, </span></span>
<span class="r-in"><span>                                 pos <span class="op">=</span> <span class="st">"darkred"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  gradient_deviation_quality <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>low <span class="op">=</span><span class="st">"yellow"</span>, high <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  x_lab                      <span class="op">=</span> <span class="st">"Trait-based distance"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="quality.fspaces.plot-1.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Camille Magneville, Nicolas Loiseau, Camille Albouy, Nicolas Casajus, Thomas Claverie, Arthur Escalas, Fabien Leprieur, Eva Maire, David Mouillot, Sebastien Villeger.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

