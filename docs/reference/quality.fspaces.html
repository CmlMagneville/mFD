<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Compute Functional Spaces their Quality — quality.fspaces • mFD</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Compute Functional Spaces their Quality — quality.fspaces" />
<meta property="og:description" content="Compute a Principal Coordinates Analysis (PCoA) using functional distance
between species. Then the function evaluates the quality of spaces built
using an increasing number of principal components. Quality is evaluated as
the (absolute or squared) deviation between trait-based distance (input) and
distance in the PCoA-based space (raw Euclidean distance or scaled distance
according to its maximum value and maximum of trait-based distance). Option
to compute a functional dendrogram and its quality. This function is based on
the framework presented in Maire et al. (2015)." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mFD</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/Compute_and_interpret_quality_of_functional_spaces.html">Compute and Interpret Quality of Functional Spaces</a>
    </li>
    <li>
      <a href="../articles/Compute_functional_hill_indices.html">Compute Functional Hill Indices</a>
    </li>
    <li>
      <a href="../articles/Continuous_traits_framework.html">Continuous Traits Framework</a>
    </li>
    <li>
      <a href="../articles/How_to_deal_with_Functional_Entities.html">How to Deal With Functional Entities</a>
    </li>
    <li>
      <a href="../articles/mFD_general_workflow.html">mFD: General Workflow</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/CmlMagneville/mFD/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Compute Functional Spaces their Quality</h1>
    <small class="dont-index">Source: <a href='https://github.com/CmlMagneville/mFD/blob/master/R/quality_fspaces.R'><code>R/quality_fspaces.R</code></a></small>
    <div class="hidden name"><code>quality.fspaces.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Compute a Principal Coordinates Analysis (PCoA) using functional distance
between species. Then the function evaluates the quality of spaces built
using an increasing number of principal components. Quality is evaluated as
the (absolute or squared) deviation between trait-based distance (input) and
distance in the PCoA-based space (raw Euclidean distance or scaled distance
according to its maximum value and maximum of trait-based distance). Option
to compute a functional dendrogram and its quality. This function is based on
the framework presented in Maire <em>et al.</em> (2015).</p>
    </div>

    <pre class="usage"><span class='fu'>quality.fspaces</span><span class='op'>(</span>
  <span class='va'>sp_dist</span>,
  fdendro <span class='op'>=</span> <span class='cn'>NULL</span>,
  maxdim_pcoa <span class='op'>=</span> <span class='fl'>10</span>,
  deviation_weighting <span class='op'>=</span> <span class='st'>"absolute"</span>,
  fdist_scaling <span class='op'>=</span> <span class='cn'>FALSE</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>sp_dist</th>
      <td><p>a dist object with pairwise distance among all species (at
least 3 species needed). Functional distance matrix from trait values can
be computed using <code><a href='funct.dist.html'>funct.dist</a></code> function.</p></td>
    </tr>
    <tr>
      <th>fdendro</th>
      <td><p>a character string indicating the clustering
algorithm to use to compute dendrogram. Should be one of the method
recognized by <code><a href='https://rdrr.io/r/stats/hclust.html'>hclust</a></code> (e.g. 'average' for UPGMA).
Default: <code>fdendro = NULL</code> (so no dendrogram computed).</p></td>
    </tr>
    <tr>
      <th>maxdim_pcoa</th>
      <td><p>a single numeric value with maximum number of PCoA axes to
consider to build multidimensional functional spaces. Default:
<code>maxdim_pcoa = 10</code>. See below about number of axes actually considered.</p></td>
    </tr>
    <tr>
      <th>deviation_weighting</th>
      <td><p>a character string referring to the
method(s) used to weight the differences between species pairwise distance
in the functional space and trait-based distance. <code>'absolute'</code>
(default) means absolute differences are used to compute mean absolute
deviation <em>mad</em> index; <code>'squared'</code> means squared differences are
used to compute root of mean squared deviation <em>rmsd</em> index. Both
values could be provided to compare quality metrics.</p></td>
    </tr>
    <tr>
      <th>fdist_scaling</th>
      <td><p>a vector with logical value(s) specifying
whether distances in the functional space should be scaled before computing
differences with trait-based distances. Scaling ensures that trait-based
distances and distances in the functional space have the same maximum.
Default: <code>FALSE</code>. Both values could be provided to compare quality metrics.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list with:</p><ul>
<li><p><code>$quality_fspaces</code>: a data frame with quality metric(s) for each
functional space. Functional spaces are named as 'pcoa_.d' and if
required 'tree_clustering method'. Quality metrics are named after
deviation_weighting ('mad' for 'absolute' and and 'rmsd' for 'squared')
and if fdist_scaling is TRUE with suffix '_scaled'.</p></li>
<li><p><code>$details_trdist</code> a list with 2 elements: <code>$trdist_summary</code>
a vector with minimum (min), maximum (max), mean (mean) and standard
deviation (sd) of <code>sp_dist</code>; <code>$trdist_euclidean</code> a logical
value indicating whether <code>sp_dist</code> checks Euclidean properties.</p></li>
<li><p><code>$details_fspaces</code> a list with 4 elements: <code>$sp_pc_coord</code>
a matrix with coordinates of species (rows) along Principal Components
(columns) with positive eigenvalues ; <code>$pc_eigenvalues</code> a matrix
with eigenvalues of axes from PCoA ; <code>$dendro</code> a hclust
object with the dendrogram details (null if no dendrogram computed) ;
<code>$pairsp_fspaces_dist</code> a dataframe containing for each pair of
species (rows), their names in the 2 first columns ('sp.x' and 'sp.y'),
their distance based on trait-values ('tr'), and their Euclidean
(for PCoA) or cophenetic (for dendrogram if computed) distance in each of
the functional space computed ('pcoa_1d', 'pcoa_2d', ... , 'tree_clust');
if <code>fdist_scaling = TRUE</code>, <code>$pairsp_fspaces_dist_scaled</code> a data
frame with scaled values of distances in functional spaces.</p></li>
<li><p><code>$details_deviation</code> a list of data frames:
<code>$dev_distsp</code> a dataframe containing for each space (columns) the
difference for all species pairs (rows) of the distance in the functional
space and trait-based distance (i.e. positive deviation indicates
overestimation of actual distance) ; <code>$abs_dev_distsp</code> and/or
<code>$sqr_dev_distsp</code>, dataframes with for each space (columns) and all
species pairs (rows) the absolute or squared deviation of distance ; if
<code>fdist_scaling = TRUE</code> <code>$dev_distsp_scaled</code>, and
<code>$abs_dev_distsp_scaled</code> and/or <code>$sqr_dev_distsp_scaled</code>, data
frames with deviation computed on scaled distance in functional spaces.</p></li>
</ul>

    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>The maximum number of dimensions considered for assessing quality of
functional spaces depends on number of PC axes with positive eigenvalues
(i.e. axes with negative eigenvalues are not considered); so it could be
lower than <code>$maxdim_pcoa</code>.
The quality metric obtained with deviation_weighting = 'squared' and
<code>fdist_scaling = TRUE</code> is equivalent to the square-root of the 'mSD'
originally suggested in Maire <em>et al.</em> (2015).</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Maire <em>et al.</em> (2015) How many dimensions are needed to accurately assess
functional diversity? A pragmatic approach for assessing the quality of
functional spaces <em>Global Ecology and Biogeography</em>, <strong>24</strong>, 728-740.</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Sebastien Villeger, Eva Maire &amp; Camille Magneville</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
<span class='co'># Load Species x Traits Data</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='st'>"fruits_traits"</span>, package <span class='op'>=</span> <span class='st'>"mFD"</span><span class='op'>)</span>

<span class='co'># Load Traits x Categories Data</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='st'>"fruits_traits_cat"</span>, package <span class='op'>=</span> <span class='st'>"mFD"</span><span class='op'>)</span>

<span class='co'># Compute Functional Distance</span>
<span class='va'>sp_dist_fruits</span> <span class='op'>&lt;-</span> <span class='fu'>mFD</span><span class='fu'>::</span><span class='fu'><a href='funct.dist.html'>funct.dist</a></span><span class='op'>(</span>
  sp_tr         <span class='op'>=</span> <span class='va'>fruits_traits</span>,
  tr_cat        <span class='op'>=</span> <span class='va'>fruits_traits_cat</span>,
  metric        <span class='op'>=</span> <span class='st'>"gower"</span>,
  scale_euclid  <span class='op'>=</span> <span class='st'>"scale_center"</span>,
  ordinal_var   <span class='op'>=</span> <span class='st'>"classic"</span>,
  weight_type   <span class='op'>=</span> <span class='st'>"equal"</span>,
  stop_if_NA    <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>

<span class='co'># Compute Functional Spaces Quality (to retrieve species coordinates)</span>
<span class='va'>fspaces_quality_fruits</span> <span class='op'>&lt;-</span> <span class='fu'>mFD</span><span class='fu'>::</span><span class='fu'>quality.fspaces</span><span class='op'>(</span>
  sp_dist             <span class='op'>=</span> <span class='va'>sp_dist_fruits</span>,
  maxdim_pcoa         <span class='op'>=</span> <span class='fl'>10</span>,
  deviation_weighting <span class='op'>=</span> <span class='st'>"absolute"</span>,
  fdist_scaling       <span class='op'>=</span> <span class='cn'>FALSE</span>,
  fdendro             <span class='op'>=</span> <span class='st'>"average"</span><span class='op'>)</span>
  
<span class='co'># Retrieve Species Coordinates</span>
<span class='va'>sp_faxes_coord_fruits</span> <span class='op'>&lt;-</span> <span class='va'>fspaces_quality_fruits</span><span class='op'>$</span><span class='va'>details_fspaces</span><span class='op'>$</span><span class='va'>sp_pc_coord</span>
<span class='op'>}</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Camille Magneville, Nicolas Loiseau, Camille Albouy, Nicolas Casajus, Thomas Claverie, Arthur Escalas, Fabien Leprieur, Eva Maire, David Mouillot, Sebastien Villeger.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


