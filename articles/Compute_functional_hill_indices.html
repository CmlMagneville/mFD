<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Compute Functional Diversity Hill Indices • mFD</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Compute Functional Diversity Hill Indices">
<meta property="og:description" content="mFD">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mFD</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Compute_and_interpret_quality_of_functional_spaces.html">Compute and Interpret Quality of Functional Spaces</a>
    </li>
    <li>
      <a href="../articles/Compute_functional_hill_indices.html">Compute Functional Diversity Hill Indices</a>
    </li>
    <li>
      <a href="../articles/Continuous_traits_framework.html">Continuous Traits Framework</a>
    </li>
    <li>
      <a href="../articles/How_to_deal_with_Functional_Entities.html">How to Deal With Functional Entities</a>
    </li>
    <li>
      <a href="../articles/mFD_general_workflow.html">mFD: General Workflow</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/CmlMagneville/mFD/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="Compute_functional_hill_indices_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Compute Functional Diversity Hill Indices</h1>
                        <h4 class="author">Sebastien Villeger</h4>
            
            <h4 class="date">2021-11-05</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/CmlMagneville/mFD/blob/master/vignettes/Compute_functional_hill_indices.Rmd"><code>vignettes/Compute_functional_hill_indices.Rmd</code></a></small>
      <div class="hidden name"><code>Compute_functional_hill_indices.Rmd</code></div>

    </div>

    
    
<div id="about-this-tutorial" class="section level1">
<h1 class="hasAnchor">
<a href="#about-this-tutorial" class="anchor"></a>About this tutorial</h1>
<div id="what-is-this-tutorial-about" class="section level2">
<h2 class="hasAnchor">
<a href="#what-is-this-tutorial-about" class="anchor"></a>What is this tutorial about?</h2>
<p><br></p>
<p>This tutorial explains how to compute the family of indices presented in <a href="https://esajournals.onlinelibrary.wiley.com/doi/full/10.1002/ecm.1343">Chao <em>et al.</em> (2019)</a> using <code>mFD</code>.</p>
<p><br></p>
</div>
<div id="lets-load-data-and-compute-functional-distance" class="section level2">
<h2 class="hasAnchor">
<a href="#lets-load-data-and-compute-functional-distance" class="anchor"></a>Let’s load data and compute functional distance</h2>
<p><br></p>
<p>The data set used to illustrate this tutorial is the <strong>fruits dataset</strong> based on 25 types of fruits (<em>i.e.</em> species) distributed in 10 fruits baskets (<em>i.e.</em> assemblages). Each fruit is characterized by six traits values summarized in the following table:</p>
<table class="table">
<thead><tr class="header">
<th align="center">Trait name</th>
<th align="center">Trait measurement</th>
<th align="center">Trait type</th>
<th align="center">Number of classes</th>
<th align="center">Classes code</th>
<th align="center">Unit</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">Size</td>
<td align="center">Maximal diameter</td>
<td align="center">Ordinal</td>
<td align="center">5</td>
<td align="center">0-1 ; 1-3 ; 3-5 ; 5-10 ; 10-20</td>
<td align="center">cm</td>
</tr>
<tr class="even">
<td align="center">Plant</td>
<td align="center">Growth form</td>
<td align="center">Categorical</td>
<td align="center">4</td>
<td align="center">tree; shrub; vine; forb</td>
<td align="center">NA</td>
</tr>
<tr class="odd">
<td align="center">Climate</td>
<td align="center">Climatic niche</td>
<td align="center">Ordinal</td>
<td align="center">3</td>
<td align="center">temperate ; subtropical ; tropical</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center">Seed</td>
<td align="center">Seed type</td>
<td align="center">Ordinal</td>
<td align="center">3</td>
<td align="center">none ; pip ; pit</td>
<td align="center">NA</td>
</tr>
<tr class="odd">
<td align="center">Sugar</td>
<td align="center">Sugar</td>
<td align="center">Continuous</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">g/kg</td>
</tr>
<tr class="even">
<td align="center">Use</td>
<td align="center">Use as food</td>
<td align="center">Fuzzy</td>
<td align="center">3</td>
<td align="center">raw ; pastry ; jam</td>
<td align="center">%</td>
</tr>
</tbody>
</table>
<p><br></p>
<p>We load the three objects used to compute functional framework (for more explanations, see <a href="https://cmlmagneville.github.io/mFD/articles/mFD_general_workflow.html">mFD General Workflow</a>):</p>
<p><br></p>
<ul>
<li>a <strong>data frame</strong> summarizing traits values for each species called <code>fruits_traits</code> in this tutorial:</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"fruits_traits"</span>, package <span class="op">=</span> <span class="st">"mFD"</span><span class="op">)</span>

<span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">fruits_traits</span><span class="op">)</span>,
      caption <span class="op">=</span> <span class="st">"Species x traits data frame based on the **fruits** dataset"</span><span class="op">)</span></code></pre></div>
<table class="table">
<caption>Species x traits data frame based on the <strong>fruits</strong> dataset</caption>
<thead><tr class="header">
<th align="left"></th>
<th align="left">Size</th>
<th align="left">Plant</th>
<th align="left">Climate</th>
<th align="left">Seed</th>
<th align="right">Sugar</th>
<th align="right">Use.raw</th>
<th align="right">Use.pastry</th>
<th align="right">Use.jam</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">apple</td>
<td align="left">5-10cm</td>
<td align="left">tree</td>
<td align="left">temperate</td>
<td align="left">pip</td>
<td align="right">103.9</td>
<td align="right">50</td>
<td align="right">50</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">apricot</td>
<td align="left">3-5cm</td>
<td align="left">tree</td>
<td align="left">temperate</td>
<td align="left">pit</td>
<td align="right">92.4</td>
<td align="right">40</td>
<td align="right">10</td>
<td align="right">50</td>
</tr>
<tr class="odd">
<td align="left">banana</td>
<td align="left">10-20cm</td>
<td align="left">tree</td>
<td align="left">tropical</td>
<td align="left">none</td>
<td align="right">122.3</td>
<td align="right">70</td>
<td align="right">20</td>
<td align="right">10</td>
</tr>
<tr class="even">
<td align="left">currant</td>
<td align="left">0-1cm</td>
<td align="left">shrub</td>
<td align="left">temperate</td>
<td align="left">pip</td>
<td align="right">73.7</td>
<td align="right">10</td>
<td align="right">10</td>
<td align="right">80</td>
</tr>
<tr class="odd">
<td align="left">blackberry</td>
<td align="left">1-3cm</td>
<td align="left">shrub</td>
<td align="left">temperate</td>
<td align="left">pip</td>
<td align="right">48.8</td>
<td align="right">30</td>
<td align="right">10</td>
<td align="right">60</td>
</tr>
<tr class="even">
<td align="left">blueberry</td>
<td align="left">0-1cm</td>
<td align="left">forb</td>
<td align="left">temperate</td>
<td align="left">pip</td>
<td align="right">100.0</td>
<td align="right">10</td>
<td align="right">40</td>
<td align="right">50</td>
</tr>
</tbody>
</table>
<p><br></p>
<ul>
<li>a <strong>matrix</strong> summarizing species assemblages called <code>baskets_fruits_weights</code> in this tutorial. Weights in this matrix can be occurrence data, abundance, biomass, coverage, etc. The studied example works with biomass (<em>i.e.</em> grams of a fruit in a basket) and this matrix looks as follows:</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"baskets_fruits_weights"</span>, package <span class="op">=</span> <span class="st">"mFD"</span><span class="op">)</span>

<span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">baskets_fruits_weights</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span><span class="op">)</span>, 
             caption <span class="op">=</span> <span class="st">"Species x assemblages matrix based on the **fruits** dataset"</span><span class="op">)</span></code></pre></div>
<table class="table">
<caption>Species x assemblages matrix based on the <strong>fruits</strong> dataset</caption>
<thead><tr class="header">
<th align="left"></th>
<th align="right">apple</th>
<th align="right">apricot</th>
<th align="right">banana</th>
<th align="right">currant</th>
<th align="right">blackberry</th>
<th align="right">blueberry</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">basket_1</td>
<td align="right">400</td>
<td align="right">0</td>
<td align="right">100</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">basket_2</td>
<td align="right">200</td>
<td align="right">0</td>
<td align="right">400</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">basket_3</td>
<td align="right">200</td>
<td align="right">0</td>
<td align="right">500</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">basket_4</td>
<td align="right">300</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">basket_5</td>
<td align="right">200</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">basket_6</td>
<td align="right">100</td>
<td align="right">0</td>
<td align="right">200</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<p><br></p>
<ul>
<li>a <strong>data frame</strong> summarizing traits types called <code>fruits_traits_cat</code> in this tutorial (for details, see <a href="https://cmlmagneville.github.io/mFD/articles/mFD_general_workflow.html">mFD General Workflow</a>):</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"fruits_traits_cat"</span>, package <span class="op">=</span> <span class="st">"mFD"</span><span class="op">)</span>
<span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">fruits_traits_cat</span><span class="op">)</span>, 
             caption <span class="op">=</span> <span class="st">"Traits types based on **fruits &amp; baskets** dataset"</span><span class="op">)</span></code></pre></div>
<table class="table">
<caption>Traits types based on <strong>fruits &amp; baskets</strong> dataset</caption>
<thead><tr class="header">
<th align="left">trait_name</th>
<th align="left">trait_type</th>
<th align="left">fuzzy_name</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Size</td>
<td align="left">O</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="left">Plant</td>
<td align="left">N</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="left">Climate</td>
<td align="left">O</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="left">Seed</td>
<td align="left">O</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="left">Sugar</td>
<td align="left">Q</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="left">Use.raw</td>
<td align="left">F</td>
<td align="left">Use</td>
</tr>
</tbody>
</table>
<p><br></p>
<p>Then, we can compute functional distance using the <code><a href="../reference/funct.dist.html">mFD::funct.dist()</a></code> function as follows:</p>
<p><strong>USAGE</strong></p>
<pre><code>## [1] "Running w.type=equal on groups=c(Size)"
## [1] "Running w.type=equal on groups=c(Plant)"
## [1] "Running w.type=equal on groups=c(Climate)"
## [1] "Running w.type=equal on groups=c(Seed)"
## [1] "Running w.type=equal on groups=c(Sugar)"
## [1] "Running w.type=equal on groups=c(Use,Use,Use)"</code></pre>
<p><br></p>
</div>
</div>
<div id="generalisation-of-hill-numbers-for-alpha-functional-diversity" class="section level1">
<h1 class="hasAnchor">
<a href="#generalisation-of-hill-numbers-for-alpha-functional-diversity" class="anchor"></a>Generalisation of Hill numbers for alpha functional diversity</h1>
<p><br></p>
<p>The family of indices presented in <a href="https://esajournals.onlinelibrary.wiley.com/doi/full/10.1002/ecm.1343">Chao <em>et al.</em> (2019)</a> allows computing FD based on pairwise distance between species and their weights in assemblages. This generalization of Hill numbers framework is based on two parameters:</p>
<ul>
<li><p><code>q</code>: the importance of species weight compared to species distance. Values allowed in <code>mFD</code> are 0, 1, 2 (the most often used, see below).</p></li>
<li><p><code>tau</code>: the threshold of functional distinctiveness between any two species (<em>i.e.</em> all species with distance above this threshold are considered as functionally equally distinct). Values allowed in <code>mFD</code> are “min(imum)”, “mean(imum)” and “max(imum)”.</p></li>
</ul>
<p><br></p>
<p>Indices are expressed as effective number of functionally equally distinct species (or <em>virtual functional groups</em>) and could thus be directly compared to taxonomic Hill numbers (including species richness).</p>
<p><br></p>
<p><strong>NOTE</strong> For more details about the properties of Hill numbers FD read <a href="https://esajournals.onlinelibrary.wiley.com/doi/full/10.1002/ecm.1343">Chao <em>et al.</em> (2019)</a> and especially its Figures 1 &amp; 2.</p>
<p><br></p>
<p>All these indices can be computed with the function <code><a href="../reference/alpha.fd.hill.html">mFD::alpha.fd.hill()</a></code>.</p>
<p><br></p>
<p>Here we start by comparing the <strong>‘classical’ Rao’s quadratic entropy expressed in Hill numbers</strong> following <a href="https://www.sciencedirect.com/science/article/pii/S0040580909001117">Ricotta &amp; Szeidl (2009)</a> which is the special case with <code>q = 2</code> and <code>tau = "max"</code>.</p>
<p><br></p>
<p><strong>USAGE</strong></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">baskets_FD2max</span> <span class="op">&lt;-</span> <span class="fu">mFD</span><span class="fu">::</span><span class="fu"><a href="../reference/alpha.fd.hill.html">alpha.fd.hill</a></span><span class="op">(</span>
  asb_sp_w <span class="op">=</span> <span class="va">baskets_fruits_weights</span>, 
  sp_dist  <span class="op">=</span> <span class="va">fruits_gower</span>, 
  tau      <span class="op">=</span> <span class="st">"max"</span>, 
  q        <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></code></pre></div>
<p><br></p>
<p>Then, we can compute <strong>Hill numbers FD of order 2</strong> computed with <code>tau = "mean"</code> and <code>q = 2</code> as recommended in <a href="https://esajournals.onlinelibrary.wiley.com/doi/full/10.1002/ecm.1343">Chao <em>et al.</em> (2019)</a></p>
<p><br></p>
<p><strong>USAGE</strong></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">baskets_FD2mean</span> <span class="op">&lt;-</span> <span class="fu">mFD</span><span class="fu">::</span><span class="fu"><a href="../reference/alpha.fd.hill.html">alpha.fd.hill</a></span><span class="op">(</span>
  asb_sp_w <span class="op">=</span> <span class="va">baskets_fruits_weights</span>, 
  sp_dist  <span class="op">=</span> <span class="va">fruits_gower</span>, 
  tau      <span class="op">=</span> <span class="st">"mean"</span>, 
  q        <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></code></pre></div>
<p><br></p>
<p>We can now compare these two metrics:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span>FD2max  <span class="op">=</span> <span class="va">baskets_FD2max</span><span class="op">$</span><span class="st">"asb_FD_Hill"</span><span class="op">[</span> , <span class="fl">1</span><span class="op">]</span>, 
            FD2mean <span class="op">=</span> <span class="va">baskets_FD2mean</span><span class="op">$</span><span class="st">"asb_FD_Hill"</span><span class="op">[</span> , <span class="fl">1</span><span class="op">]</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span></code></pre></div>
<pre><code>##           FD2max FD2mean
## basket_1    1.50    2.62
## basket_2    1.83    3.97
## basket_3    1.86    4.10
## basket_4    1.27    1.72
## basket_5    1.30    1.85
## basket_6    1.74    3.73
## basket_7    1.82    3.94
## basket_8    1.40    2.16
## basket_9    1.53    2.75
## basket_10   1.53    3.01</code></pre>
<p><br></p>
<p>We can see that FD computed with <code>tau = "max"</code> is less variable (ranging from 1.50 to only 1.86) than FD computed with <code>tau = "min"</code> (ranging from 1.72 to 4.10) illustrating its <strong>higher sensitivity to functional differences between species</strong>.</p>
<p><br></p>
<p><strong>NB</strong> <strong>Note that even with</strong> <code>q = 0</code><strong>, weights of species are still accounted for by FD.</strong> Hence, if the goal is to compute a richness-like index (<em>i.e.</em> accounting only for distance between species present), function <code><a href="../reference/alpha.fd.hill.html">mFD::alpha.fd.hill()</a></code> should be applied to <strong>species occurrence data</strong> (coded as 0/1, previously computed using sp.tr.summary) so that all species have the same weight). Species occurrence data can be retrieve through the <code><a href="../reference/asb.sp.summary.html">mFD::asb.sp.summary()</a></code> function:</p>
<p><br></p>
<p><strong>USAGE</strong></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Retrieve species occurrences data:</span>
<span class="va">baskets_summary</span>    <span class="op">&lt;-</span> <span class="fu">mFD</span><span class="fu">::</span><span class="fu"><a href="../reference/asb.sp.summary.html">asb.sp.summary</a></span><span class="op">(</span><span class="va">baskets_fruits_weights</span><span class="op">)</span>
<span class="va">baskets_fruits_occ</span> <span class="op">&lt;-</span> <span class="va">baskets_summary</span><span class="op">$</span><span class="st">"asb_sp_occ"</span>

<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">baskets_fruits_occ</span><span class="op">)</span></code></pre></div>
<pre><code>##          apple apricot banana currant blackberry blueberry cherry grape
## basket_1     1       0      1       0          0         0      1     0
## basket_2     1       0      1       0          0         0      1     0
## basket_3     1       0      1       0          0         0      1     0
## basket_4     1       0      0       0          0         0      0     0
## basket_5     1       0      0       0          0         0      0     0
## basket_6     1       0      1       0          0         0      0     0
##          grapefruit kiwifruit lemon lime litchi mango melon orange
## basket_1          0         0     1    0      0     0     1      0
## basket_2          0         0     1    0      0     0     1      0
## basket_3          0         0     1    0      0     0     1      0
## basket_4          0         1     1    0      0     0     0      1
## basket_5          0         1     1    0      0     0     0      1
## basket_6          0         0     0    1      1     1     0      1
##          passion_fruit peach pear pineapple plum raspberry strawberry tangerine
## basket_1             1     0    1         0    0         0          1         0
## basket_2             1     0    1         0    0         0          1         0
## basket_3             1     0    1         0    0         0          1         0
## basket_4             0     1    1         0    1         0          0         1
## basket_5             0     1    1         0    1         0          0         1
## basket_6             0     0    0         1    0         0          0         0
##          water_melon
## basket_1           0
## basket_2           0
## basket_3           0
## basket_4           0
## basket_5           0
## basket_6           1</code></pre>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Compute alpha FD Hill with q = 0:</span>
<span class="va">baskets_FD0mean</span> <span class="op">&lt;-</span> <span class="fu">mFD</span><span class="fu">::</span><span class="fu"><a href="../reference/alpha.fd.hill.html">alpha.fd.hill</a></span><span class="op">(</span>
  asb_sp_w <span class="op">=</span> <span class="va">baskets_fruits_occ</span>, 
  sp_dist  <span class="op">=</span> <span class="va">fruits_gower</span>, 
  tau      <span class="op">=</span> <span class="st">"mean"</span>, 
  q        <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">baskets_FD0mean</span><span class="op">$</span><span class="st">"asb_FD_Hill"</span>, <span class="fl">2</span><span class="op">)</span></code></pre></div>
<pre><code>##           FD_q0
## basket_1   4.73
## basket_2   4.73
## basket_3   4.73
## basket_4   1.93
## basket_5   1.93
## basket_6   4.57
## basket_7   4.57
## basket_8   3.67
## basket_9   3.67
## basket_10  3.52</code></pre>
<p><br></p>
<p>We can see that baskets with same composition of fruits species have same FD values (<em>e.g</em> <em>basket_1</em>, <em>basket_2</em> and <em>basket_3</em>)</p>
<p><br></p>
</div>
<div id="generalisation-of-hill-numbers-for-beta-functional-diversity" class="section level1">
<h1 class="hasAnchor">
<a href="#generalisation-of-hill-numbers-for-beta-functional-diversity" class="anchor"></a>Generalisation of Hill numbers for beta functional diversity</h1>
<p><br></p>
<p>Framework of <a href="https://esajournals.onlinelibrary.wiley.com/doi/full/10.1002/ecm.1343">Chao <em>et al.</em> (2019)</a> also allows computing beta-diversity, with 2 framework similar to Jaccard and Sorensen ones for taxonomic diversity. The <code>mFD:beta.fd.hill()</code> function computes these indices.</p>
<p><br></p>
<p><strong>NB</strong> Note that <strong>total weight of assemblages is affecting computation of functional beta-diversity</strong>. Hence <strong>if it is does not reflect an ecological pattern</strong> (<em>e.g</em>. rather difference in sampling effort), it is recommended to <strong>apply</strong> <code><a href="../reference/beta.fd.hill.html">mFD::beta.fd.hill()</a></code> <strong>to relative weight of species in assemblages</strong>.</p>
<p><br></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># retrieve total weight per basket:</span>
<span class="va">baskets_summary</span><span class="op">$</span><span class="st">"asb_tot_w"</span></code></pre></div>
<pre><code>##  basket_1  basket_2  basket_3  basket_4  basket_5  basket_6  basket_7  basket_8 
##      2000      2000      2000      2000      2000      2000      2000      2000 
##  basket_9 basket_10 
##      2000      2000</code></pre>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Here baskets all contain 2000g of fruits, we illustrate how to compute...</span>
<span class="co"># relative weights using the output of asb.sp.summary:</span>

<span class="va">baskets_fruits_relw</span> <span class="op">&lt;-</span> <span class="va">baskets_fruits_weights</span> <span class="op">/</span> <span class="va">baskets_summary</span><span class="op">$</span><span class="st">"asb_tot_w"</span>
<span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">baskets_fruits_relw</span>, <span class="fl">1</span>, <span class="va">sum</span><span class="op">)</span></code></pre></div>
<pre><code>##  basket_1  basket_2  basket_3  basket_4  basket_5  basket_6  basket_7  basket_8 
##         1         1         1         1         1         1         1         1 
##  basket_9 basket_10 
##         1         1</code></pre>
<p><br></p>
<p>Now we can compute functional beta-diversity of order <code>q = 2</code> (with <code>tau = "mean"</code> for higher sensitivity) with Jaccard-type index:</p>
<p><br></p>
<p><strong>USAGE</strong></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Compute index:</span>
<span class="va">baskets_betaq2</span> <span class="op">&lt;-</span> <span class="fu">mFD</span><span class="fu">::</span><span class="fu"><a href="../reference/beta.fd.hill.html">beta.fd.hill</a></span><span class="op">(</span>
  asb_sp_w  <span class="op">=</span> <span class="va">baskets_fruits_relw</span>, 
  sp_dist   <span class="op">=</span> <span class="va">fruits_gower</span>, 
  q         <span class="op">=</span> <span class="fl">2</span>,
  tau       <span class="op">=</span> <span class="st">"mean"</span>, 
  beta_type <span class="op">=</span> <span class="st">"Jaccard"</span><span class="op">)</span>

<span class="co"># Then use the mFD::dist.to.df function to ease visualizing result</span>
<span class="fu">mFD</span><span class="fu">::</span><span class="fu"><a href="../reference/dist.to.df.html">dist.to.df</a></span><span class="op">(</span>list_dist <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">"FDq2"</span> <span class="op">=</span> <span class="va">baskets_betaq2</span><span class="op">$</span><span class="st">"beta_fd_q"</span><span class="op">$</span><span class="st">"q2"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## Registered S3 method overwritten by 'dendextend':
##   method     from 
##   rev.hclust vegan</code></pre>
<pre><code>##          x1        x2        FDq2
## 1  basket_1  basket_2 0.058982325
## 2  basket_1  basket_3 0.078716397
## 3  basket_1  basket_4 0.029573623
## 4  basket_1  basket_5 0.027059789
## 5  basket_1  basket_6 0.484115290
## 6  basket_1  basket_7 0.292594562
## 7  basket_1  basket_8 0.290545545
## 8  basket_1  basket_9 0.185475113
## 9  basket_1 basket_10 0.011136995
## 10 basket_2  basket_3 0.004420448
## 11 basket_2  basket_4 0.161833512
## 12 basket_2  basket_5 0.162571972
## 13 basket_2  basket_6 0.260541701
## 14 basket_2  basket_7 0.097053161
## 15 basket_2  basket_8 0.294504888
## 16 basket_2  basket_9 0.225897615
## 17 basket_2 basket_10 0.058298760
## 18 basket_3  basket_4 0.172877455
## 19 basket_3  basket_5 0.178123024
## 20 basket_3  basket_6 0.207102590
## 21 basket_3  basket_7 0.081951839
## 22 basket_3  basket_8 0.308336365
## 23 basket_3  basket_9 0.241482168
## 24 basket_3 basket_10 0.082649928
## 25 basket_4  basket_5 0.001049851
## 26 basket_4  basket_6 0.511165067
## 27 basket_4  basket_7 0.421141181
## 28 basket_4  basket_8 0.482330219
## 29 basket_4  basket_9 0.342926459
## 30 basket_4 basket_10 0.050817451
## 31 basket_5  basket_6 0.532084800
## 32 basket_5  basket_7 0.438841544
## 33 basket_5  basket_8 0.496554512
## 34 basket_5  basket_9 0.336894275
## 35 basket_5 basket_10 0.044052657
## 36 basket_6  basket_7 0.068382884
## 37 basket_6  basket_8 0.759422492
## 38 basket_6  basket_9 0.680332414
## 39 basket_6 basket_10 0.453325136
## 40 basket_7  basket_8 0.478528108
## 41 basket_7  basket_9 0.431531941
## 42 basket_7 basket_10 0.265928889
## 43 basket_8  basket_9 0.020812705
## 44 basket_8 basket_10 0.345652088
## 45 basket_9 basket_10 0.219780509</code></pre>
<p>We can see that <em>basket 1</em> is similar (beta &lt; 0.1) to <em>baskets 2,3,4,5,10</em> and that it is the most dissimilar to <em>basket 8 (beta &gt; 0.5)</em>. <em>Baskets 4 and 5</em> are highly dissimilar (beta &gt; 0.8) to <em>basket 8</em>.</p>
<p><br></p>
</div>
<div id="references" class="section level1">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<p><br></p>
<ul>
<li><p>Chao <em>et al.</em> (2019) An attribute diversity approach to functional diversity, functional beta diversity, and related (dis)similarity measures. <em>Ecological Monographs</em>, <strong>89</strong>, e01343.</p></li>
<li><p>Ricotta &amp; Szeidl (2009) Diversity partitioning of Rao’s quadratic entropy. <em>Theoretical Population Biology</em>, <strong>76</strong>, 299-302.</p></li>
</ul>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Camille Magneville, Nicolas Loiseau, Camille Albouy, Nicolas Casajus, Thomas Claverie, Arthur Escalas, Fabien Leprieur, Eva Maire, David Mouillot, Sebastien Villeger.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
