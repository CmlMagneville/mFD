<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Continuous Traits Framework • mFD</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Continuous Traits Framework">
<meta property="og:description" content="mFD">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mFD</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Compute_and_interpret_quality_of_functional_spaces.html">Compute and Interpret Quality of Functional Spaces</a>
    </li>
    <li>
      <a href="../articles/Compute_functional_hill_indices.html">Compute Functional Hill Indices</a>
    </li>
    <li>
      <a href="../articles/Continuous_traits_framework.html">Continuous Traits Framework</a>
    </li>
    <li>
      <a href="../articles/How_to_deal_with_Functional_Entities.html">How to Deal With Functional Entities</a>
    </li>
    <li>
      <a href="../articles/mFD_general_workflow.html">mFD: General Workflow</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/CmlMagneville/mFD/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="Continuous_traits_framework_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Continuous Traits Framework</h1>
                        <h4 class="author">Camille Magneville</h4>
            
            <h4 class="date">2021-04-06</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/CmlMagneville/mFD/blob/master/vignettes/Continuous_traits_framework.Rmd"><code>vignettes/Continuous_traits_framework.Rmd</code></a></small>
      <div class="hidden name"><code>Continuous_traits_framework.Rmd</code></div>

    </div>

    
    
<div id="about-this-tutorial" class="section level1">
<h1 class="hasAnchor">
<a href="#about-this-tutorial" class="anchor"></a>About this tutorial</h1>
<p><br></p>
<p>This tutorial explains the workflow to use to compute functional space based on continuous traits and it shows how to retrieve species coordinates and species functional distances in the functional space.</p>
<p><br></p>
<p>🧩 This tutorial uses a dataset from one of the 80 CESTES database (Jeliazkov &amp; the CESTES consortium (2019)) based on <a href="https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0040679">Villéger <em>et al.</em> 2012</a>. This dataframe contains 45 fish species from the Terminos Lagoon (Gulf of Mexico) gathered into 36 sites considered as assemblages. Each species is described with 16 continuous morphological traits.</p>
<p><br></p>
<p>When the dataset <strong>only</strong> gathers continuous traits, the functional space can be computed using one trait for one dimension or using Principal Component Analysis (PCA: convert correlations among samples into a 2D plot). 💡 Using a PCoA on continuous traits and euclidean distance is the same than using a PCA (clusters made by minimizing the linear distance (PCoA) are the same as those obtained by maximizing linear correlations (PCA)).</p>
<p><br></p>
</div>
<div id="load-dataset" class="section level1">
<h1 class="hasAnchor">
<a href="#load-dataset" class="anchor"></a>1 - Load dataset:</h1>
<p><br></p>
<p>The species traits dataframe has rows corresponding to species and columns corresponding to traits. The different traits are summed up in the following table:</p>
<p><br></p>
<table class="table">
<thead><tr class="header">
<th align="center">Trait name</th>
<th align="center">Trait signification</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">logM</td>
<td align="center">log(mass)</td>
</tr>
<tr class="even">
<td align="center">Ogsf</td>
<td align="center">Oral gape surface</td>
</tr>
<tr class="odd">
<td align="center">OgSh</td>
<td align="center">Oral gape shape</td>
</tr>
<tr class="even">
<td align="center">OgPo</td>
<td align="center">Oral gape position</td>
</tr>
<tr class="odd">
<td align="center">GrLg</td>
<td align="center">Gill raker length</td>
</tr>
<tr class="even">
<td align="center">GtLg</td>
<td align="center">Gut length</td>
</tr>
<tr class="odd">
<td align="center">EySz</td>
<td align="center">Eye size</td>
</tr>
<tr class="even">
<td align="center">EyPo</td>
<td align="center">Eye position</td>
</tr>
<tr class="odd">
<td align="center">BdSh</td>
<td align="center">Body transversal shape</td>
</tr>
<tr class="even">
<td align="center">BdSf</td>
<td align="center">Body transversal surface</td>
</tr>
<tr class="odd">
<td align="center">PfPo</td>
<td align="center">Pectoral fin position</td>
</tr>
<tr class="even">
<td align="center">PfSh</td>
<td align="center">Aspect ratio of the pectoral fin</td>
</tr>
<tr class="odd">
<td align="center">CpHt</td>
<td align="center">Caudal peduncle throttling</td>
</tr>
<tr class="even">
<td align="center">CfSh</td>
<td align="center">Aspect ratio of the caudal fin</td>
</tr>
<tr class="odd">
<td align="center">FsRt</td>
<td align="center">Fins surface ratio</td>
</tr>
<tr class="even">
<td align="center">FsSf</td>
<td align="center">Fins surface to body size ratio</td>
</tr>
</tbody>
</table>
<p><br></p>
<p>To work with <code>mFD</code> with only continuous traits, you must load two objects:</p>
<ul>
<li>
<code>sp_tr</code> : species-trait dataframe:</li>
</ul>
<p><br></p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># load dataset:</span>
<span class="va">sp_tr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"data_cestes_sp_tr.csv"</span>, 
                              package <span class="op">=</span> <span class="st">"mFD"</span><span class="op">)</span>, dec <span class="op">=</span> <span class="st">","</span>, sep <span class="op">=</span> <span class="st">":"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">sp_tr</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">sp_tr</span><span class="op">$</span><span class="va">Sp</span>
<span class="va">sp_tr</span> <span class="op">&lt;-</span> <span class="va">sp_tr</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span>

<span class="co"># display the table:</span>
<span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">sp_tr</span><span class="op">)</span>, 
             caption <span class="op">=</span> <span class="st">"Species x traits dataframe based on *CESTES* dataset"</span><span class="op">)</span></code></pre></div>
<table class="table">
<caption>Species x traits dataframe based on <em>CESTES</em> dataset</caption>
<colgroup>
<col width="22%">
<col width="4%">
<col width="4%">
<col width="4%">
<col width="4%">
<col width="4%">
<col width="4%">
<col width="4%">
<col width="4%">
<col width="4%">
<col width="4%">
<col width="4%">
<col width="4%">
<col width="4%">
<col width="4%">
<col width="4%">
<col width="4%">
</colgroup>
<thead><tr class="header">
<th align="left"></th>
<th align="right">logM</th>
<th align="right">OgSf</th>
<th align="right">OgSh</th>
<th align="right">OgPo</th>
<th align="right">EySz</th>
<th align="right">GrLg</th>
<th align="right">GtLg</th>
<th align="right">EyPo</th>
<th align="right">BdSh</th>
<th align="right">BdSf</th>
<th align="right">PfPo</th>
<th align="right">PfSh</th>
<th align="right">CpHt</th>
<th align="right">CfSh</th>
<th align="right">FsRt</th>
<th align="right">FsSf</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Achirus_lineatus</td>
<td align="right">2.187</td>
<td align="right">0.072</td>
<td align="right">0.947</td>
<td align="right">1.000</td>
<td align="right">0.151</td>
<td align="right">0.000</td>
<td align="right">1.782</td>
<td align="right">1.000</td>
<td align="right">0.143</td>
<td align="right">2.168</td>
<td align="right">0.000</td>
<td align="right">0.000</td>
<td align="right">1.121</td>
<td align="right">0.767</td>
<td align="right">0.000</td>
<td align="right">1.158</td>
</tr>
<tr class="even">
<td align="left">Anchoa_mitchilli</td>
<td align="right">0.706</td>
<td align="right">0.283</td>
<td align="right">2.054</td>
<td align="right">0.508</td>
<td align="right">0.474</td>
<td align="right">0.381</td>
<td align="right">0.688</td>
<td align="right">0.584</td>
<td align="right">3.292</td>
<td align="right">3.974</td>
<td align="right">0.773</td>
<td align="right">2.708</td>
<td align="right">2.493</td>
<td align="right">3.108</td>
<td align="right">0.504</td>
<td align="right">2.618</td>
</tr>
<tr class="odd">
<td align="left">Archosargus_probatocephalus</td>
<td align="right">2.674</td>
<td align="right">0.082</td>
<td align="right">0.754</td>
<td align="right">0.221</td>
<td align="right">0.282</td>
<td align="right">0.035</td>
<td align="right">2.591</td>
<td align="right">0.652</td>
<td align="right">3.091</td>
<td align="right">1.679</td>
<td align="right">0.666</td>
<td align="right">4.740</td>
<td align="right">2.584</td>
<td align="right">2.393</td>
<td align="right">1.526</td>
<td align="right">1.504</td>
</tr>
<tr class="even">
<td align="left">Archosargus_rhomboidalis</td>
<td align="right">3.327</td>
<td align="right">0.056</td>
<td align="right">0.648</td>
<td align="right">0.273</td>
<td align="right">0.294</td>
<td align="right">0.032</td>
<td align="right">3.467</td>
<td align="right">0.647</td>
<td align="right">3.102</td>
<td align="right">1.596</td>
<td align="right">0.638</td>
<td align="right">6.868</td>
<td align="right">2.906</td>
<td align="right">2.684</td>
<td align="right">1.060</td>
<td align="right">1.502</td>
</tr>
<tr class="odd">
<td align="left">Ariopsis_felis</td>
<td align="right">3.110</td>
<td align="right">0.173</td>
<td align="right">0.513</td>
<td align="right">0.346</td>
<td align="right">0.263</td>
<td align="right">0.128</td>
<td align="right">2.078</td>
<td align="right">0.647</td>
<td align="right">1.021</td>
<td align="right">1.658</td>
<td align="right">0.806</td>
<td align="right">3.480</td>
<td align="right">3.592</td>
<td align="right">4.052</td>
<td align="right">0.781</td>
<td align="right">1.648</td>
</tr>
<tr class="even">
<td align="left">Bagre_marinus</td>
<td align="right">2.170</td>
<td align="right">0.248</td>
<td align="right">0.519</td>
<td align="right">0.489</td>
<td align="right">0.357</td>
<td align="right">0.142</td>
<td align="right">2.154</td>
<td align="right">0.613</td>
<td align="right">1.016</td>
<td align="right">2.087</td>
<td align="right">0.662</td>
<td align="right">3.674</td>
<td align="right">4.205</td>
<td align="right">3.460</td>
<td align="right">0.625</td>
<td align="right">1.678</td>
</tr>
</tbody>
</table>
<p><br></p>
<ul>
<li>
<code>asb_sp_w</code> : species-assemblage dataframe summarizing biomass recorded in a volume of 4500m^3 per site and per species:</li>
</ul>
<p><br></p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/knitr/">knitr</a></span><span class="op">)</span>
<span class="co"># load dataset:</span>
<span class="va">asb_sp_w</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"data_cestes_asb_sp_w.csv"</span>, 
                                 package <span class="op">=</span> <span class="st">"mFD"</span><span class="op">)</span>, dec <span class="op">=</span> <span class="st">","</span>, sep <span class="op">=</span> <span class="st">":"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">asb_sp_w</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"site"</span>, sep <span class="op">=</span> <span class="st">"_"</span>, <span class="va">asb_sp_w</span><span class="op">$</span><span class="va">Sites</span><span class="op">)</span>
<span class="va">asb_sp_w</span> <span class="op">&lt;-</span> <span class="va">asb_sp_w</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span>
<span class="va">asb_sp_w</span><span class="op">$</span><span class="va">Urobatis_jamaicensis</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">asb_sp_w</span><span class="op">$</span><span class="va">Urobatis_jamaicensis</span><span class="op">)</span>

<span class="co"># remove sites 12, 23, 35 because FRic can not be computed on it...</span>
<span class="co"># ... (for a clean example):</span>
<span class="va">asb_sp_w</span> <span class="op">&lt;-</span> <span class="va">asb_sp_w</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">11</span>, <span class="fl">22</span>, <span class="fl">33</span><span class="op">)</span>, <span class="op">]</span>

<span class="co"># display the table:</span>
<span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">asb_sp_w</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">7</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span><span class="op">]</span>, 
  caption <span class="op">=</span> <span class="st">"Species x assemblages dataframe based on *CESTES* dataset for 
  the first six species and first seven sites"</span><span class="op">)</span></code></pre></div>
<table class="table">
<caption>Species x assemblages dataframe based on <em>CESTES</em> dataset for the first six species and first seven sites</caption>
<colgroup>
<col width="5%">
<col width="13%">
<col width="13%">
<col width="22%">
<col width="20%">
<col width="12%">
<col width="11%">
</colgroup>
<thead><tr class="header">
<th align="left"></th>
<th align="right">Achirus_lineatus</th>
<th align="right">Anchoa_mitchilli</th>
<th align="right">Archosargus_probatocephalus</th>
<th align="right">Archosargus_rhomboidalis</th>
<th align="right">Ariopsis_felis</th>
<th align="right">Bagre_marinus</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">site_1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">169.8</td>
<td align="right">66.5</td>
</tr>
<tr class="even">
<td align="left">site_2</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">29.5</td>
</tr>
<tr class="odd">
<td align="left">site_3</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">592.4</td>
<td align="right">0.0</td>
</tr>
<tr class="even">
<td align="left">site_5</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">0.0</td>
</tr>
<tr class="odd">
<td align="left">site_6</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">0.0</td>
</tr>
<tr class="even">
<td align="left">site_7</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">135.4</td>
<td align="right">0.0</td>
</tr>
<tr class="odd">
<td align="left">site_8</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">0.0</td>
</tr>
</tbody>
</table>
<p><br></p>
</div>
<div id="compute-the-functional-space" class="section level1">
<h1 class="hasAnchor">
<a href="#compute-the-functional-space" class="anchor"></a>2 - Compute the functional space</h1>
<p><br></p>
<p>Based on the species-trait dataframe or the species-standardized traits dataframe, <code>mFD</code> allows to build a functional space based on a PCA or using each trait as a dimension. The function used to computed functional space with continuous traits is called <code><a href="../reference/tr.cont.fspace.html">mFD::tr.cont.fspace()</a></code> and is used as follows:</p>
<p><br></p>
<p><strong>USAGE</strong></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">mFD</span><span class="fu">::</span><span class="fu"><a href="../reference/tr.cont.fspace.html">tr.cont.fspace</a></span><span class="op">(</span>
                  sp_tr        <span class="op">=</span> <span class="va">sp_tr</span>, 
                  pca          <span class="op">=</span> <span class="cn">TRUE</span>, 
                  nb_dim       <span class="op">=</span> <span class="fl">7</span>, 
                  scaling      <span class="op">=</span> <span class="st">"scale_center"</span>,
                  compute_corr <span class="op">=</span> <span class="st">"pearson"</span><span class="op">)</span></code></pre></div>
<p><br></p>
<p>It takes as inputs:</p>
<ul>
<li>the <em>sp_tr</em> dataframe</li>
<li>a <em>pca</em> argument that must be set to TRUE if you want to compute a PCA or to FALSE if you want to use each trait as a dimension to construct the multidimensional space</li>
<li>a <em>nb_dim</em> argument referring to the maximum number of dimensions for multidimensional functional spaces. Final number of dimensions depends on the number of positive eigenvalues obtained with PCA if <em>pca = TRUE</em> or the number of traits used if <em>pca = FALSE</em>. 💡 High value for <em>nb_dim</em> can increase computation time.</li>
<li>a <em>scaling</em> argument allowing traits values to be standardized. They can be standardized in several ways: standardization by the range value of the trait, center-transformation, scale transformation or scale-center transformation can be used. You can also chose not to standardize traits values. 👉 Scaling ensures that trait-based distances and distances in the functional space have the same maximum. Scaling distances implies that the quality of the functional space accounts for congruence in distances rather than their equality</li>
<li>a <em>compute_corr</em> argument which refers to a string value to compute Pearson correlation coefficients between traits using <em>“pearson”</em> or not using <em>"none</em>.</li>
</ul>
<p><br></p>
<p>In this example, we will compute a PCA based on a maximum number of 7 dimensions and get Pearson’s correlation coefficients:</p>
<p><br></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fspace</span> <span class="op">&lt;-</span> <span class="fu">mFD</span><span class="fu">::</span><span class="fu"><a href="../reference/tr.cont.fspace.html">tr.cont.fspace</a></span><span class="op">(</span>
                      sp_tr       <span class="op">=</span> <span class="va">sp_tr</span>, 
                      pca         <span class="op">=</span> <span class="cn">TRUE</span>, 
                      nb_dim      <span class="op">=</span> <span class="fl">10</span>, 
                      scaling     <span class="op">=</span> <span class="st">"scale_center"</span>,
                     compute_corr <span class="op">=</span> <span class="st">"pearson"</span><span class="op">)</span></code></pre></div>
<p><br></p>
<p>If the PCA is computed, the output contains:</p>
<ul>
<li>quality metrics for spaces from 2 dimensions to <em>nb_dim</em> dimensions: 💡 <strong>mean absolute deviation (mad)</strong> reflects the actual magnitude of errors that affect distances, hence FD metrics ; <strong>mean squared deviation (msd)</strong> reflects the potential risk associated with a few species pairs being strongly misplaced in the functional space (<a href="https://onlinelibrary.wiley.com/doi/full/10.1111/geb.12299">Maire <em>et al.</em> (2015)</a>).</li>
</ul>
<p><br></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fspace</span><span class="op">$</span><span class="va">`quality_metrics`</span></code></pre></div>
<pre><code>##             mAD          mSD
## 2D  0.999172097 9.983449e-01
## 3D  0.707790003 5.009667e-01
## 4D  0.447618543 2.003633e-01
## 5D  0.249227670 6.211478e-02
## 6D  0.122568133 1.502303e-02
## 7D  0.061225618 3.748582e-03
## 8D  0.033760939 1.139802e-03
## 9D  0.020479668 4.194212e-04
## 10D 0.009164095 8.398065e-05</code></pre>
<p><br></p>
<p>💡 The lower the quality metric is, the better the quality of your space is. Here, thanks to mAD and mSD value, we can see that as the number of dimensions increases, the quality increases. However, to decrease computation time, we can chose to work with the 6D space which has good quality of functional space. Generally, you must keep in mind a trade-off between the number of axes and quality of functional space. Increasing the number of functional axes increases computation time.</p>
<p><br></p>
<ul>
<li>a matrix of species coordinates in the functional space:</li>
</ul>
<p><br></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">fspace</span><span class="op">$</span><span class="va">sp_faxes_coord</span><span class="op">)</span></code></pre></div>
<pre><code>##                                  Dim.1      Dim.2     Dim.3       Dim.4
## Achirus_lineatus            -3.5468021 -2.2967608 -1.251164 -0.94434329
## Anchoa_mitchilli             1.5768146 -0.5190331 -1.916811  0.17507940
## Archosargus_probatocephalus  1.2488122  0.1995554  1.407921 -0.24268501
## Archosargus_rhomboidalis     2.1724589  1.4658850  3.077086 -0.83141781
## Ariopsis_felis               0.2493960 -0.7334141  2.091296 -0.06344991
## Bagre_marinus                0.6885315 -0.7629772  1.600313 -0.21706433
##                                  Dim.5      Dim.6      Dim.7      Dim.8
## Achirus_lineatus            -0.3551794 -0.7674608  0.6577158 -0.5915840
## Anchoa_mitchilli            -1.4102174 -1.0235770  1.7253132  0.8741535
## Archosargus_probatocephalus  0.2635153  0.8865692  0.3189349  0.1482548
## Archosargus_rhomboidalis     0.5917141  0.8916854  0.2586945 -0.2766138
## Ariopsis_felis              -1.6439468 -1.0382383 -0.6405055  0.3789258
## Bagre_marinus               -2.0758840 -0.8373182 -0.2436820 -0.6143684
##                                    Dim.9      Dim.10
## Achirus_lineatus            -0.003361492 -0.14305954
## Anchoa_mitchilli            -0.279834057  0.48767139
## Archosargus_probatocephalus -0.212999873 -0.42603541
## Archosargus_rhomboidalis    -0.316020951  0.01968203
## Ariopsis_felis              -0.048960051 -0.25937975
## Bagre_marinus               -0.092163957 -0.10443150</code></pre>
<p><br></p>
<ul>
<li>a dist object containing species euclidean distances in the functional space (here 5D space) for the first five species:</li>
</ul>
<p><br></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dist_mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">fspace</span><span class="op">$</span><span class="va">sp_dist</span><span class="op">$</span><span class="va">`6D`</span><span class="op">)</span>
<span class="va">dist_mat</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span><span class="op">]</span></code></pre></div>
<pre><code>##                             Achirus_lineatus Anchoa_mitchilli
## Achirus_lineatus                    0.000000         5.682135
## Anchoa_mitchilli                    5.682135         0.000000
## Archosargus_probatocephalus         6.317529         4.278126
## Archosargus_rhomboidalis            8.322459         6.158141
## Ariopsis_felis                      5.526068         4.240832
##                             Archosargus_probatocephalus
## Achirus_lineatus                               6.317529
## Anchoa_mitchilli                               4.278126
## Archosargus_probatocephalus                    0.000000
## Archosargus_rhomboidalis                       2.386875
## Ariopsis_felis                                 3.116358
##                             Archosargus_rhomboidalis Ariopsis_felis
## Achirus_lineatus                            8.322459       5.526068
## Anchoa_mitchilli                            6.158141       4.240832
## Archosargus_probatocephalus                 2.386875       3.116358
## Archosargus_rhomboidalis                    0.000000       4.338137
## Ariopsis_felis                              4.338137       0.000000</code></pre>
<p><br></p>
<ul>
<li>a correlation matrix containing correlation between traits and their associated pvalue:</li>
</ul>
<p><br></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fspace</span><span class="op">$</span><span class="va">tr_correl</span></code></pre></div>
<pre><code>##       logM  OgSf  OgSh  OgPo  EySz  GrLg  GtLg  EyPo  BdSh  BdSf  PfPo  PfSh
## logM  1.00 -0.05 -0.62 -0.41  0.07 -0.27  0.22  0.48 -0.48 -0.69 -0.35 -0.27
## OgSf -0.05  1.00  0.19  0.04  0.14  0.28 -0.22  0.03 -0.18 -0.05  0.17 -0.07
## OgSh -0.62  0.19  1.00  0.14  0.06  0.35 -0.19 -0.48  0.75  0.57  0.31  0.34
## OgPo -0.41  0.04  0.14  1.00 -0.15 -0.06 -0.11  0.22 -0.05  0.16 -0.30 -0.37
## EySz  0.07  0.14  0.06 -0.15  1.00  0.34 -0.21 -0.14 -0.21 -0.15  0.12  0.41
## GrLg -0.27  0.28  0.35 -0.06  0.34  1.00  0.13 -0.38  0.10  0.16  0.50  0.21
## GtLg  0.22 -0.22 -0.19 -0.11 -0.21  0.13  1.00 -0.18 -0.02 -0.21  0.24 -0.15
## EyPo  0.48  0.03 -0.48  0.22 -0.14 -0.38 -0.18  1.00 -0.62 -0.31 -0.86 -0.65
## BdSh -0.48 -0.18  0.75 -0.05 -0.21  0.10 -0.02 -0.62  1.00  0.50  0.35  0.47
## BdSf -0.69 -0.05  0.57  0.16 -0.15  0.16 -0.21 -0.31  0.50  1.00  0.16  0.05
## PfPo -0.35  0.17  0.31 -0.30  0.12  0.50  0.24 -0.86  0.35  0.16  1.00  0.50
## PfSh -0.27 -0.07  0.34 -0.37  0.41  0.21 -0.15 -0.65  0.47  0.05  0.50  1.00
## CpHt -0.46 -0.07  0.50 -0.05 -0.36  0.12  0.09 -0.61  0.75  0.48  0.41  0.35
## CfSh -0.44 -0.05  0.37 -0.13 -0.09  0.27  0.28 -0.73  0.53  0.35  0.61  0.40
## FsRt  0.08  0.25 -0.21 -0.30 -0.42 -0.06  0.11  0.00 -0.05  0.13  0.15 -0.17
## FsSf  0.32  0.19 -0.13 -0.58  0.29  0.00 -0.28  0.30 -0.19 -0.01 -0.25  0.15
##       CpHt  CfSh  FsRt  FsSf
## logM -0.46 -0.44  0.08  0.32
## OgSf -0.07 -0.05  0.25  0.19
## OgSh  0.50  0.37 -0.21 -0.13
## OgPo -0.05 -0.13 -0.30 -0.58
## EySz -0.36 -0.09 -0.42  0.29
## GrLg  0.12  0.27 -0.06  0.00
## GtLg  0.09  0.28  0.11 -0.28
## EyPo -0.61 -0.73  0.00  0.30
## BdSh  0.75  0.53 -0.05 -0.19
## BdSf  0.48  0.35  0.13 -0.01
## PfPo  0.41  0.61  0.15 -0.25
## PfSh  0.35  0.40 -0.17  0.15
## CpHt  1.00  0.81  0.17 -0.22
## CfSh  0.81  1.00 -0.03 -0.25
## FsRt  0.17 -0.03  1.00  0.17
## FsSf -0.22 -0.25  0.17  1.00
## 
## n= 45 
## 
## 
## P
##      logM   OgSf   OgSh   OgPo   EySz   GrLg   GtLg   EyPo   BdSh   BdSf  
## logM        0.7651 0.0000 0.0057 0.6264 0.0738 0.1394 0.0010 0.0009 0.0000
## OgSf 0.7651        0.2153 0.7759 0.3746 0.0632 0.1512 0.8559 0.2328 0.7626
## OgSh 0.0000 0.2153        0.3540 0.7084 0.0196 0.2164 0.0009 0.0000 0.0000
## OgPo 0.0057 0.7759 0.3540        0.3200 0.6850 0.4850 0.1492 0.7320 0.2970
## EySz 0.6264 0.3746 0.7084 0.3200        0.0217 0.1688 0.3552 0.1752 0.3416
## GrLg 0.0738 0.0632 0.0196 0.6850 0.0217        0.4014 0.0092 0.5024 0.3083
## GtLg 0.1394 0.1512 0.2164 0.4850 0.1688 0.4014        0.2431 0.8801 0.1633
## EyPo 0.0010 0.8559 0.0009 0.1492 0.3552 0.0092 0.2431        0.0000 0.0365
## BdSh 0.0009 0.2328 0.0000 0.7320 0.1752 0.5024 0.8801 0.0000        0.0005
## BdSf 0.0000 0.7626 0.0000 0.2970 0.3416 0.3083 0.1633 0.0365 0.0005       
## PfPo 0.0198 0.2608 0.0364 0.0465 0.4391 0.0005 0.1170 0.0000 0.0179 0.2825
## PfSh 0.0713 0.6297 0.0237 0.0129 0.0049 0.1765 0.3167 0.0000 0.0010 0.7222
## CpHt 0.0017 0.6657 0.0005 0.7423 0.0137 0.4351 0.5597 0.0000 0.0000 0.0008
## CfSh 0.0027 0.7412 0.0126 0.4075 0.5349 0.0752 0.0648 0.0000 0.0002 0.0168
## FsRt 0.6006 0.1010 0.1606 0.0483 0.0043 0.6867 0.4784 0.9796 0.7473 0.4052
## FsSf 0.0344 0.2210 0.3825 0.0000 0.0554 0.9783 0.0604 0.0428 0.2024 0.9353
##      PfPo   PfSh   CpHt   CfSh   FsRt   FsSf  
## logM 0.0198 0.0713 0.0017 0.0027 0.6006 0.0344
## OgSf 0.2608 0.6297 0.6657 0.7412 0.1010 0.2210
## OgSh 0.0364 0.0237 0.0005 0.0126 0.1606 0.3825
## OgPo 0.0465 0.0129 0.7423 0.4075 0.0483 0.0000
## EySz 0.4391 0.0049 0.0137 0.5349 0.0043 0.0554
## GrLg 0.0005 0.1765 0.4351 0.0752 0.6867 0.9783
## GtLg 0.1170 0.3167 0.5597 0.0648 0.4784 0.0604
## EyPo 0.0000 0.0000 0.0000 0.0000 0.9796 0.0428
## BdSh 0.0179 0.0010 0.0000 0.0002 0.7473 0.2024
## BdSf 0.2825 0.7222 0.0008 0.0168 0.4052 0.9353
## PfPo        0.0005 0.0047 0.0000 0.3207 0.1029
## PfSh 0.0005        0.0181 0.0070 0.2514 0.3267
## CpHt 0.0047 0.0181        0.0000 0.2722 0.1433
## CfSh 0.0000 0.0070 0.0000        0.8596 0.0914
## FsRt 0.3207 0.2514 0.2722 0.8596        0.2563
## FsSf 0.1029 0.3267 0.1433 0.0914 0.2563</code></pre>
<p><br></p>
<p>Here we can notice that there is no strong correlation between traits. 💡 However, if some strong correlation is to be found, then one of the two correlated trait can be remove from the analysis.</p>
<p>If the PCA is not computed, outputs are the same except that mad and msd are not computed.</p>
<p><br></p>
</div>
<div id="plot-functional-space-compute-and-illustrate-indices" class="section level1">
<h1 class="hasAnchor">
<a href="#plot-functional-space-compute-and-illustrate-indices" class="anchor"></a>4 - Plot functional space, compute and illustrate indices</h1>
<p><br></p>
<p>Then, based on the species coordinates matrix, steps are similar as those listed in the <a href="https://cmlmagneville.github.io/mFD/articles/mFD_general_workflow.html">mFD: General Workflow</a> , from step 5 till the end.</p>
<p><br></p>
</div>
<div id="references" class="section level1">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References:</h1>
<p><br></p>
<p>Maire <em>et al.</em> (2015) How many dimensions are needed to accurately assess functional diversity? A pragmatic approach for assessing the quality of functional spaces <em>Global Ecology and Biogeography</em>, <strong>24</strong>, 728-740. Villéger <em>et al.</em> (2012) Low Functional β-Diversity Despite High Taxonomic β-Diversity among Tropical Estuarine Fish Communities <em>PLoS ONE</em>, <strong>7</strong>.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Camille Magneville, Nicolas Loiseau, Camille Albouy, Nicolas Casajus, Thomas Claverie, Arthur Escalas, Fabien Leprieur, Eva Maire, David Mouillot, Sebastien Villeger.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
