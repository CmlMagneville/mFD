<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Compute and Interpret Quality of Functional Spaces • mFD</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Compute and Interpret Quality of Functional Spaces">
<meta property="og:description" content="mFD">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mFD</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.5.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Compute_and_interpret_quality_of_functional_spaces.html">Compute and Interpret Quality of Functional Spaces</a>
    </li>
    <li>
      <a href="../articles/Compute_functional_hill_indices.html">Compute Functional Diversity Hill Indices</a>
    </li>
    <li>
      <a href="../articles/Continuous_traits_framework.html">Continuous Traits Framework</a>
    </li>
    <li>
      <a href="../articles/Customised_plots.html">Customised plots</a>
    </li>
    <li>
      <a href="../articles/How_to_deal_with_Functional_Entities.html">How to Deal With Functional Entities</a>
    </li>
    <li>
      <a href="../articles/mFD_general_workflow.html">mFD: General Workflow</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/CmlMagneville/mFD/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Compute and Interpret Quality of Functional
Spaces</h1>
                        <h4 data-toc-skip class="author">Sebastien
Villeger</h4>
            
            <h4 data-toc-skip class="date">2023-10-16</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/CmlMagneville/mFD/blob/HEAD/vignettes/Compute_and_interpret_quality_of_functional_spaces.Rmd" class="external-link"><code>vignettes/Compute_and_interpret_quality_of_functional_spaces.Rmd</code></a></small>
      <div class="hidden name"><code>Compute_and_interpret_quality_of_functional_spaces.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="about-this-tutorial">About this tutorial<a class="anchor" aria-label="anchor" href="#about-this-tutorial"></a>
</h2>
<p><br></p>
<p>This tutorial illustrates how to compute and interpret quality of
functional spaces using <code>mFD</code>, with a special emphasis on how
functional dendrograms and functional spaces with a low dimension could
distort original trait-based distances. This tutorial also explains why
square-rooting the original distances before computing PCoA may be
misleading.</p>
<p><br></p>
</div>
<div class="section level2">
<h2 id="tutorials-data">1. Tutorial’s data<a class="anchor" aria-label="anchor" href="#tutorials-data"></a>
</h2>
<p><br></p>
<p><strong>DATA</strong> The dataset used to illustrate this tutorial is
<em>a fruit dataset</em> based on 25 types of fruits. Each fruit is
characterized by 5 traits summarized in the following table:</p>
<table class="table">
<colgroup>
<col width="15%">
<col width="21%">
<col width="15%">
<col width="22%">
<col width="18%">
<col width="7%">
</colgroup>
<thead><tr class="header">
<th align="center">Trait name</th>
<th align="center">Trait measurement</th>
<th align="center">Trait type</th>
<th align="center">Number of classes</th>
<th align="center">Classes code</th>
<th align="center">Unit</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">Size</td>
<td align="center">Maximal diameter</td>
<td align="center">Ordinal</td>
<td align="center">5</td>
<td align="center">0-1 ; 1-3 ; 3-5 ; 5-10 ; 10-20</td>
<td align="center">cm</td>
</tr>
<tr class="even">
<td align="center">Plant</td>
<td align="center">Growth form</td>
<td align="center">Categorical</td>
<td align="center">4</td>
<td align="center">tree; schrub; vine; forb</td>
<td align="center">NA</td>
</tr>
<tr class="odd">
<td align="center">Climate</td>
<td align="center">Climatic niche</td>
<td align="center">Ordinal</td>
<td align="center">3</td>
<td align="center">temperate ; subtropical ; tropical</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center">Seed</td>
<td align="center">Seed type</td>
<td align="center">Ordinal</td>
<td align="center">3</td>
<td align="center">none ; pip ; pit</td>
<td align="center">NA</td>
</tr>
<tr class="odd">
<td align="center">Sugar</td>
<td align="center">Sugar</td>
<td align="center">Continuous</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">g/kg</td>
</tr>
</tbody>
</table>
<p><br></p>
<p><strong>NOTE</strong> This dataset is a subset of the dataset used in
the <a href="https://cmlmagneville.github.io/mFD/articles/mFD_general_workflow.html">mFD:
General Workflow</a> tutorial to keep only non-fuzzy traits.</p>
<p><br></p>
<p>The dataframe gathering species traits, looks as follows:</p>
<p><br></p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"fruits_traits"</span>, package <span class="op">=</span> <span class="st">"mFD"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># remove non-fuzzy traits:</span></span>
<span><span class="va">fruits_traits</span> <span class="op">&lt;-</span> <span class="va">fruits_traits</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># plot the table:</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">fruits_traits</span><span class="op">)</span>, </span>
<span>             caption <span class="op">=</span> <span class="st">"Species x traits dataframe based on *fruits* dataset"</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Species x traits dataframe based on <em>fruits</em>
dataset</caption>
<thead><tr class="header">
<th align="left"></th>
<th align="left">Size</th>
<th align="left">Plant</th>
<th align="left">Climate</th>
<th align="left">Seed</th>
<th align="right">Sugar</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">apple</td>
<td align="left">5-10cm</td>
<td align="left">tree</td>
<td align="left">temperate</td>
<td align="left">pip</td>
<td align="right">103.9</td>
</tr>
<tr class="even">
<td align="left">apricot</td>
<td align="left">3-5cm</td>
<td align="left">tree</td>
<td align="left">temperate</td>
<td align="left">pit</td>
<td align="right">92.4</td>
</tr>
<tr class="odd">
<td align="left">banana</td>
<td align="left">10-20cm</td>
<td align="left">tree</td>
<td align="left">tropical</td>
<td align="left">none</td>
<td align="right">122.3</td>
</tr>
<tr class="even">
<td align="left">currant</td>
<td align="left">0-1cm</td>
<td align="left">shrub</td>
<td align="left">temperate</td>
<td align="left">pip</td>
<td align="right">73.7</td>
</tr>
<tr class="odd">
<td align="left">blackberry</td>
<td align="left">1-3cm</td>
<td align="left">shrub</td>
<td align="left">temperate</td>
<td align="left">pip</td>
<td align="right">48.8</td>
</tr>
<tr class="even">
<td align="left">blueberry</td>
<td align="left">0-1cm</td>
<td align="left">forb</td>
<td align="left">temperate</td>
<td align="left">pip</td>
<td align="right">100.0</td>
</tr>
</tbody>
</table>
<p><br></p>
<p>Thus, this dataset contains 5 traits: 3 ordinal (Size, Climate,
Seed), 1 categorical (Plant type), 1 continuous (sugar content):</p>
<p><br></p>
<pre><code><span><span class="co">##       Size     Plant           Climate     Seed        Sugar       </span></span>
<span><span class="co">##  0-1cm  :2   forb : 5   temperate  :15   none: 2   Min.   : 16.90  </span></span>
<span><span class="co">##  1-3cm  :6   shrub: 3   subtropical: 4   pip :17   1st Qu.: 73.70  </span></span>
<span><span class="co">##  3-5cm  :5   tree :14   tropical   : 6   pit : 6   Median : 92.40  </span></span>
<span><span class="co">##  5-10cm :6   vine : 3                              Mean   : 90.66  </span></span>
<span><span class="co">##  10-20cm:6                                         3rd Qu.:105.80  </span></span>
<span><span class="co">##                                                    Max.   :162.50</span></span></code></pre>
<p><br></p>
<p>These traits are summed up in the following dataframe (details: <a href="https://cmlmagneville.github.io/mFD/articles/mFD_general_workflow.html">mFD:
General Workflow</a> tutorial):</p>
<p><br></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fruits_traits_cat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">fruits_traits</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"O"</span>,<span class="st">"N"</span>,<span class="st">"O"</span>,<span class="st">"O"</span>,<span class="st">"Q"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">fruits_traits_cat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"trait_name"</span>, <span class="st">"trait_type"</span><span class="op">)</span></span>
<span><span class="va">fruits_traits_cat</span></span></code></pre></div>
<pre><code><span><span class="co">##   trait_name trait_type</span></span>
<span><span class="co">## 1       Size          O</span></span>
<span><span class="co">## 2      Plant          N</span></span>
<span><span class="co">## 3    Climate          O</span></span>
<span><span class="co">## 4       Seed          O</span></span>
<span><span class="co">## 5      Sugar          Q</span></span></code></pre>
<p><br></p>
</div>
<div class="section level2">
<h2 id="compute-trait-based-distance-between-species">2. Compute trait-based distance between species<a class="anchor" aria-label="anchor" href="#compute-trait-based-distance-between-species"></a>
</h2>
<p><br></p>
<p>First, trait-based distance between species should be computed using
<code><a href="../reference/funct.dist.html">mFD::funct.dist()</a></code>. Here we use Gower distance.</p>
<p><br></p>
<p><strong>USAGE</strong></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># compute trait-based distances:</span></span>
<span><span class="va">dist_fruits</span> <span class="op">&lt;-</span> <span class="fu">mFD</span><span class="fu">::</span><span class="fu"><a href="../reference/funct.dist.html">funct.dist</a></span><span class="op">(</span></span>
<span>  sp_tr         <span class="op">=</span> <span class="va">fruits_traits</span>,</span>
<span>  tr_cat        <span class="op">=</span> <span class="va">fruits_traits_cat</span>,</span>
<span>  metric        <span class="op">=</span> <span class="st">"gower"</span>,</span>
<span>  scale_euclid  <span class="op">=</span> <span class="st">"noscale"</span>,</span>
<span>  ordinal_var   <span class="op">=</span> <span class="st">"classic"</span>,</span>
<span>  weight_type   <span class="op">=</span> <span class="st">"equal"</span>,</span>
<span>  stop_if_NA    <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># sum up the distance matrix:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">dist_fruits</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##      apple           apricot           banana          currant      </span></span>
<span><span class="co">##  Min.   :0.0000   Min.   :0.0000   Min.   :0.0000   Min.   :0.0000  </span></span>
<span><span class="co">##  1st Qu.:0.1658   1st Qu.:0.2184   1st Qu.:0.3448   1st Qu.:0.3723  </span></span>
<span><span class="co">##  Median :0.2848   Median :0.3607   Median :0.5027   Median :0.4257  </span></span>
<span><span class="co">##  Mean   :0.2813   Mean   :0.3285   Mean   :0.4774   Mean   :0.4317  </span></span>
<span><span class="co">##  3rd Qu.:0.3805   3rd Qu.:0.4165   3rd Qu.:0.5945   3rd Qu.:0.5169  </span></span>
<span><span class="co">##  Max.   :0.5574   Max.   :0.7084   Max.   :0.7668   Max.   :0.7864  </span></span>
<span><span class="co">##    blackberry       blueberry          cherry           grape       </span></span>
<span><span class="co">##  Min.   :0.0000   Min.   :0.0000   Min.   :0.0000   Min.   :0.0000  </span></span>
<span><span class="co">##  1st Qu.:0.3565   1st Qu.:0.3269   1st Qu.:0.2422   1st Qu.:0.3562  </span></span>
<span><span class="co">##  Median :0.4099   Median :0.4011   Median :0.4089   Median :0.4370  </span></span>
<span><span class="co">##  Mean   :0.4102   Mean   :0.4094   Mean   :0.3689   Mean   :0.4447  </span></span>
<span><span class="co">##  3rd Qu.:0.4834   3rd Qu.:0.5165   3rd Qu.:0.4526   3rd Qu.:0.5140  </span></span>
<span><span class="co">##  Max.   :0.7706   Max.   :0.7503   Max.   :0.7908   Max.   :0.7379  </span></span>
<span><span class="co">##    grapefruit       kiwifruit          lemon             lime       </span></span>
<span><span class="co">##  Min.   :0.0000   Min.   :0.0000   Min.   :0.0000   Min.   :0.0000  </span></span>
<span><span class="co">##  1st Qu.:0.2648   1st Qu.:0.2804   1st Qu.:0.2084   1st Qu.:0.3360  </span></span>
<span><span class="co">##  Median :0.3265   Median :0.3628   Median :0.4033   Median :0.4130  </span></span>
<span><span class="co">##  Mean   :0.3321   Mean   :0.3668   Mean   :0.3531   Mean   :0.4133  </span></span>
<span><span class="co">##  3rd Qu.:0.4588   3rd Qu.:0.3891   3rd Qu.:0.4418   3rd Qu.:0.5121  </span></span>
<span><span class="co">##  Max.   :0.5728   Max.   :0.6857   Max.   :0.5889   Max.   :0.6500  </span></span>
<span><span class="co">##      litchi           mango            melon            orange      </span></span>
<span><span class="co">##  Min.   :0.0000   Min.   :0.0000   Min.   :0.0000   Min.   :0.0000  </span></span>
<span><span class="co">##  1st Qu.:0.3360   1st Qu.:0.3423   1st Qu.:0.2848   1st Qu.:0.2103  </span></span>
<span><span class="co">##  Median :0.4665   Median :0.4033   Median :0.3975   Median :0.3121  </span></span>
<span><span class="co">##  Mean   :0.4678   Mean   :0.4597   Mean   :0.3807   Mean   :0.2985  </span></span>
<span><span class="co">##  3rd Qu.:0.6420   3rd Qu.:0.6141   3rd Qu.:0.4652   3rd Qu.:0.4584  </span></span>
<span><span class="co">##  Max.   :0.7512   Max.   :0.7864   Max.   :0.7512   Max.   :0.4977  </span></span>
<span><span class="co">##  passion_fruit        peach             pear          pineapple     </span></span>
<span><span class="co">##  Min.   :0.0000   Min.   :0.0000   Min.   :0.0000   Min.   :0.0000  </span></span>
<span><span class="co">##  1st Qu.:0.4054   1st Qu.:0.2103   1st Qu.:0.1614   1st Qu.:0.4523  </span></span>
<span><span class="co">##  Median :0.4695   Median :0.3537   Median :0.2760   Median :0.5510  </span></span>
<span><span class="co">##  Mean   :0.4449   Mean   :0.3324   Mean   :0.2787   Mean   :0.5329  </span></span>
<span><span class="co">##  3rd Qu.:0.5368   3rd Qu.:0.4548   3rd Qu.:0.3827   3rd Qu.:0.7010  </span></span>
<span><span class="co">##  Max.   :0.5886   Max.   :0.6701   Max.   :0.5514   Max.   :0.7908  </span></span>
<span><span class="co">##       plum          raspberry        strawberry       tangerine     </span></span>
<span><span class="co">##  Min.   :0.0000   Min.   :0.0000   Min.   :0.0000   Min.   :0.0000  </span></span>
<span><span class="co">##  1st Qu.:0.2091   1st Qu.:0.3630   1st Qu.:0.2841   1st Qu.:0.2091  </span></span>
<span><span class="co">##  Median :0.3628   Median :0.4165   Median :0.4098   Median :0.3139  </span></span>
<span><span class="co">##  Mean   :0.3291   Mean   :0.4152   Mean   :0.3941   Mean   :0.3005  </span></span>
<span><span class="co">##  3rd Qu.:0.4258   3rd Qu.:0.4872   3rd Qu.:0.4832   3rd Qu.:0.4282  </span></span>
<span><span class="co">##  Max.   :0.7010   Max.   :0.7772   Max.   :0.7705   Max.   :0.5100  </span></span>
<span><span class="co">##   water_melon    </span></span>
<span><span class="co">##  Min.   :0.0000  </span></span>
<span><span class="co">##  1st Qu.:0.2812  </span></span>
<span><span class="co">##  Median :0.4011  </span></span>
<span><span class="co">##  Mean   :0.3794  </span></span>
<span><span class="co">##  3rd Qu.:0.4617  </span></span>
<span><span class="co">##  Max.   :0.7477</span></span></code></pre>
<p><br></p>
<p>The Gower distances range from &lt; 0.01 to 0.790. For instance,
Gower distances between blackberry and 3 other fruits are:</p>
<p><br></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># retrieve fruits names:</span></span>
<span><span class="va">ex_blackberry</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"blackberry"</span>,<span class="st">"currant"</span>,<span class="st">"cherry"</span>,<span class="st">"banana"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># get the distance matrix only for these species:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">dist_fruits</span><span class="op">)</span><span class="op">[</span><span class="va">ex_blackberry</span>, <span class="va">ex_blackberry</span><span class="op">]</span>, <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##            blackberry currant cherry banana</span></span>
<span><span class="co">## blackberry       0.00    0.08   0.41   0.75</span></span>
<span><span class="co">## currant          0.08    0.00   0.42   0.77</span></span>
<span><span class="co">## cherry           0.41    0.42   0.00   0.56</span></span>
<span><span class="co">## banana           0.75    0.77   0.56   0.00</span></span></code></pre>
<p><br></p>
<p>Those observed differences in values are intuitively related to trait
values of these 4 species:</p>
<p><br></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fruits_traits</span><span class="op">[</span><span class="va">ex_blackberry</span>, <span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">##               Size Plant   Climate Seed Sugar</span></span>
<span><span class="co">## blackberry   1-3cm shrub temperate  pip  48.8</span></span>
<span><span class="co">## currant      0-1cm shrub temperate  pip  73.7</span></span>
<span><span class="co">## cherry       1-3cm  tree temperate  pit 128.2</span></span>
<span><span class="co">## banana     10-20cm  tree  tropical none 122.3</span></span></code></pre>
<p><br></p>
<p>Indeed:</p>
<ul>
<li><p>blackberry shares 3 traits values with currant and these 2
species have close values for other 2 traits which explains the low
distance (&lt; 0.1)</p></li>
<li><p>blackberry shares 2 traits with cherry (size and climate),
differs slightly for seed size (by only 1 order) but is quite different
in terms of plant type and sugar content, hence Gower distance is around
0.5</p></li>
<li><p>blackberry is maximally different to banana for ordinal traits,
difference for categorical and sugar content differ by a 2.5 factor,
hence Gower distance is high (&gt; 0.8).</p></li>
</ul>
<p><br></p>
</div>
<div class="section level2">
<h2 id="compute-functional-space-quality-metrics-and-plot-them">3. Compute functional space, quality metrics and plot them<a class="anchor" aria-label="anchor" href="#compute-functional-space-quality-metrics-and-plot-them"></a>
</h2>
<p><br></p>
<div class="section level3">
<h3 id="compute-functional-spaces-and-associated-quality-metrics">3.1. Compute functional spaces and associated quality metrics<a class="anchor" aria-label="anchor" href="#compute-functional-spaces-and-associated-quality-metrics"></a>
</h3>
<p><br></p>
<p>We now compute varying number of functional space from 1 to 9
dimensions based on a PCoA as well as an UPGMA dendrogram using
<code><a href="../reference/quality.fspaces.html">mFD::quality.fspaces()</a></code> function. We also compute 4 quality
metrics <em>(= all combinations of deviation weighting and distance
scaling)</em> (details: <a href="https://cmlmagneville.github.io/mFD/articles/mFD_general_workflow.html">mFD
General Workflow</a> tutorial, <strong>step 4.1</strong>).</p>
<p><br></p>
<p><strong>USAGE</strong></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># use quality.fpscaes function to compute quality metrics:</span></span>
<span><span class="va">quality_fspaces_fruits</span> <span class="op">&lt;-</span> <span class="fu">mFD</span><span class="fu">::</span><span class="fu"><a href="../reference/quality.fspaces.html">quality.fspaces</a></span><span class="op">(</span></span>
<span>  sp_dist             <span class="op">=</span> <span class="va">dist_fruits</span>,</span>
<span>  fdendro             <span class="op">=</span> <span class="st">"average"</span>,</span>
<span>  maxdim_pcoa         <span class="op">=</span> <span class="fl">9</span>,</span>
<span>  deviation_weighting <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"absolute"</span>, <span class="st">"squared"</span><span class="op">)</span>,</span>
<span>  fdist_scaling       <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Registered S3 method overwritten by 'dendextend':</span></span>
<span><span class="co">##   method     from </span></span>
<span><span class="co">##   rev.hclust vegan</span></span></code></pre>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># display the table gathering quality metrics:</span></span>
<span><span class="va">quality_fspaces_fruits</span><span class="op">$</span><span class="st">"quality_fspaces"</span></span></code></pre></div>
<pre><code><span><span class="co">##                     mad       rmsd mad_scaled rmsd_scaled</span></span>
<span><span class="co">## pcoa_1d      0.14960800 0.19275417 0.14395689  0.18875975</span></span>
<span><span class="co">## pcoa_2d      0.07260544 0.10110390 0.07492961  0.10306073</span></span>
<span><span class="co">## pcoa_3d      0.04696520 0.06505328 0.04730734  0.06524948</span></span>
<span><span class="co">## pcoa_4d      0.04000008 0.05415334 0.03430576  0.04874494</span></span>
<span><span class="co">## pcoa_5d      0.04946642 0.06180911 0.03885764  0.05214018</span></span>
<span><span class="co">## pcoa_6d      0.05537470 0.06660442 0.04286165  0.05561341</span></span>
<span><span class="co">## pcoa_7d      0.05951430 0.06979397 0.04572100  0.05826640</span></span>
<span><span class="co">## pcoa_8d      0.06353017 0.07314032 0.04796894  0.06039689</span></span>
<span><span class="co">## pcoa_9d      0.06464350 0.07410817 0.04882052  0.06119030</span></span>
<span><span class="co">## tree_average 0.08204566 0.10937029 0.19229494  0.22468355</span></span></code></pre>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># retrieve the functional space associated with minimal quality metric: </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">quality_fspaces_fruits</span><span class="op">$</span><span class="va">quality_fspaces</span>, <span class="fl">2</span>, <span class="va">which.min</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##         mad        rmsd  mad_scaled rmsd_scaled </span></span>
<span><span class="co">##           4           4           4           4</span></span></code></pre>
<p><br></p>
<p>The best space (with the minimum deviation between trait-based
distance and space-based distance) is the 4D according to all
indices.</p>
<p>Then using the output of <code><a href="../reference/quality.fspaces.html">mFD::quality.fspaces()</a></code>, we plot
quality metrics of each space:</p>
<p><br></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://magrittr.tidyverse.org" class="external-link">"magrittr"</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">quality_fspaces_fruits</span><span class="op">$</span><span class="st">"quality_fspaces"</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span>rownames <span class="op">=</span> <span class="st">"Funct.space"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span><span class="op">!</span> <span class="va">Funct.space</span>, names_to <span class="op">=</span> <span class="st">"quality_metric"</span>, values_to <span class="op">=</span> <span class="st">"Quality"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Funct.space</span>, y <span class="op">=</span> <span class="va">Quality</span>, </span>
<span>                               color <span class="op">=</span> <span class="va">quality_metric</span>, shape <span class="op">=</span> <span class="va">quality_metric</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> </span></code></pre></div>
<p><img src="Compute_and_interpret_quality_of_functional_spaces_files/figure-html/unnamed-chunk-8-1.png" width="1152" style="display: block; margin: auto;"></p>
<p><br></p>
<p><strong>NB</strong> The higher the value of metric, the higher the
deviations between trait-based and space-based distance between species,
hence the lower the quality of the functional space is.</p>
<p><br></p>
<p>We can here notice that:</p>
<ul>
<li><p>inaccuracy of dendrogram (shown on the right) is much higher than
inaccuracy of spaces made of at least 3 dimensions</p></li>
<li><p>ranking of spaces is only slightly affected by quality metric,
with here higher values for indices based on squared deviation</p></li>
<li><p>scaling distance increases inaccuracy of dendrogram</p></li>
</ul>
<p><br></p>
<p>As FD indices will eventually be computed on coordinates on space
(hence raw distance), we hereafter will consider only the mean
absolute-deviation metric.</p>
<p><br></p>
<p>The raw and absolute deviation of distances for only dendrogram and
2, 3, 4D spaces are plotted below thanks to the
<code><a href="../reference/quality.fspaces.plot.html">mFD::quality.fspaces.plot()</a></code> function:</p>
<p><br></p>
<p><strong>USAGE</strong></p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">mFD</span><span class="fu">::</span><span class="fu"><a href="../reference/quality.fspaces.plot.html">quality.fspaces.plot</a></span><span class="op">(</span></span>
<span>  fspaces_quality <span class="op">=</span> <span class="va">quality_fspaces_fruits</span>, </span>
<span>  quality_metric  <span class="op">=</span> <span class="st">"mad"</span>,</span>
<span>  fspaces_plot    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"tree_average"</span>, <span class="st">"pcoa_2d"</span>, <span class="st">"pcoa_3d"</span>, <span class="st">"pcoa_4d"</span>, <span class="st">'pcoa_5d'</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="Compute_and_interpret_quality_of_functional_spaces_files/figure-html/unnamed-chunk-9-1.png" width="1152" style="display: block; margin: auto;"></p>
<p><br></p>
<p>2D and 3D spaces bias distance (hence have high deviation, see top
row) because some species pairs are closer in those spaces than they
have close trait values. In the 4D space most species pairs are
accurately represented (absolute deviation &lt; 0.1).</p>
<p><br></p>
</div>
<div class="section level3">
<h3 id="focus-on-dendrograms">3.2. Focus on dendrograms<a class="anchor" aria-label="anchor" href="#focus-on-dendrograms"></a>
</h3>
<p><br></p>
<p><strong>NB</strong> <strong>Many of the pairwise distance on
dendrogram deviate by more than 0.3 from the trait-based
distances</strong> (top-left panel of the above figure), particularly
with some of the highest distances on the dendrogram corresponding to
pairs of species with actually close trait values (Gower distance &lt;
0.3). The dichotomous nature of dendrogram implies that many species
pairs have the same distance, with especially all species pairs being on
different sides of the tree root having all the maximal distance.</p>
<p><br></p>
<p>For instance, let’s consider the 3 fruits: lemon, lime and
cherry:</p>
<p><br></p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># get fruits traits:</span></span>
<span><span class="va">fruits_traits</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cherry"</span>, <span class="st">"lime"</span>, <span class="st">"lemon"</span><span class="op">)</span>, <span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">##          Size Plant     Climate Seed Sugar</span></span>
<span><span class="co">## cherry  1-3cm  tree   temperate  pit 128.2</span></span>
<span><span class="co">## lime    3-5cm  tree    tropical  pip  16.9</span></span>
<span><span class="co">## lemon  5-10cm  tree subtropical  pip  25.0</span></span></code></pre>
<p><br></p>
<p>The 2 Citrus fruits have similar trait values and differ from the
cherry. Now let’s have a look at their pairwise distances: Gower
distance on trait values, Euclidean distance in the 4 dimensions PCoA
space and cophenetic distance on the UPGMA dendrogram.</p>
<p><br></p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">quality_fspaces_fruits</span><span class="op">$</span><span class="st">"details_fspaces"</span><span class="op">$</span><span class="st">"pairsp_fspaces_dist"</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">sp.x</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cherry"</span>, <span class="st">"lime"</span>, <span class="st">"lemon"</span><span class="op">)</span> <span class="op">&amp;</span> </span>
<span>                <span class="va">sp.y</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cherry"</span>, <span class="st">"lime"</span>, <span class="st">"lemon"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">sp.x</span>, <span class="va">sp.y</span>, <span class="va">tr</span>, <span class="va">pcoa_4d</span>, <span class="va">tree_average</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">across</a></span><span class="op">(</span><span class="fu">where</span><span class="op">(</span><span class="va">is.numeric</span><span class="op">)</span>, <span class="va">round</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    sp.x   sp.y   tr pcoa_4d tree_average</span></span>
<span><span class="co">## 1 lemon cherry 0.44    0.46         0.26</span></span>
<span><span class="co">## 2  lime cherry 0.50    0.54         0.34</span></span>
<span><span class="co">## 3  lime  lemon 0.16    0.22         0.34</span></span></code></pre>
<p><br></p>
<p>As expected given trait values, Gower distance between lime and lemon
is 2.75 (0.44/0.16 = 2.75) times lower than distance between each of
them and cherry. Euclidean distances in the 4D space (pcoa_4d) are very
similar to those Gower distance, with only a slight overestimation.
Meanwhile, on the UPGMA dendrogram, lime is as distant to lemon than to
the cherry and lemon is even closer to the cherry than to the lime. This
is an illustration of the usual bias of <strong>dendrogram that
overestimates distance between some pairs of species having actually
similar trait values</strong>.</p>
<p><br></p>
<p>Now let’s have look to the distance between pineapple and other
fruits:</p>
<p><br></p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">quality_fspaces_fruits</span><span class="op">$</span><span class="st">"details_fspaces"</span><span class="op">$</span><span class="st">"pairsp_fspaces_dist"</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">sp.x</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pineapple"</span><span class="op">)</span> <span class="op">|</span> <span class="va">sp.y</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pineapple"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>fruit <span class="op">=</span> <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_replace.html" class="external-link">str_replace_all</a></span><span class="op">(</span>string <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">sp.x</span>, <span class="st">""</span>, <span class="va">sp.y</span><span class="op">)</span>,</span>
<span>                                                 pattern <span class="op">=</span> <span class="st">"pineapple"</span>, replacement <span class="op">=</span> <span class="st">""</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">fruit</span>, Gower_distance <span class="op">=</span> <span class="va">tr</span>, Cophenetic_distance <span class="op">=</span> <span class="va">tree_average</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Gower_distance</span>, y <span class="op">=</span> <span class="va">Cophenetic_distance</span>, label <span class="op">=</span> <span class="va">fruit</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">2</span>, nudge_y <span class="op">=</span> <span class="fl">0.08</span>, check_overlap <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_abline</a></span><span class="op">(</span>slope <span class="op">=</span> <span class="fl">1</span>, intercept <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="Compute_and_interpret_quality_of_functional_spaces_files/figure-html/unnamed-chunk-12-1.png" width="1152" style="display: block; margin: auto;"></p>
<p><br></p>
<p>The cophenetic distance on the dendrogram between pineapple and all
species but banana is 0.53 while trait-based Gower distance with those
22 fruits varied by a two-fold magnitude from 0.32 (water melon) to 0.73
(currant). This homogenization of distance is due to the ultrametricity
of the dendrogram, <em>i.e.</em> a species is at the same distance to
all species not on the same main branch (<em>i.e.</em> descending from
the root). Let’s plot of UPGMA dendrogram:</p>
<p><br></p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">quality_fspaces_fruits</span><span class="op">$</span><span class="st">"details_fspaces"</span><span class="op">$</span><span class="st">"dendro"</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/dendrogram.html" class="external-link">as.dendrogram</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dendextend</span><span class="fu">::</span><span class="fu"><a href="http://talgalili.github.io/dendextend/reference/plot_horiz.dendrogram.html" class="external-link">plot_horiz.dendrogram</a></span><span class="op">(</span>side <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="Compute_and_interpret_quality_of_functional_spaces_files/figure-html/unnamed-chunk-13-1.png" width="1152" style="display: block; margin: auto;"></p>
<p><br></p>
<p>We notice that pineapple is in the ‘outer’ group with other tropical
fruits and that lime is as ‘close’ to cherry than to lemon.</p>
<p><br></p>
</div>
<div class="section level3">
<h3 id="focus-on-the-effect-of-square-rooting-distance-matrix-before-computing-pcoa">3.3. Focus on the effect of square-rooting distance matrix before
computing PcoA<a class="anchor" aria-label="anchor" href="#focus-on-the-effect-of-square-rooting-distance-matrix-before-computing-pcoa"></a>
</h3>
<p><br></p>
<p>A known ‘issue’ associated with the Gower metric applied to
non-continuous traits is that distance matrix is not Euclidean. Let’s
have a look:</p>
<p><br></p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># check if distance matrix checks Euclidean properties:</span></span>
<span><span class="va">quality_fspaces_fruits</span><span class="op">$</span><span class="st">"details_trdist"</span><span class="op">$</span><span class="st">"trdist_euclidean"</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] FALSE</span></span></code></pre>
<p><br></p>
<p>It is <code>FALSE</code> with the fruit case: this is actually
intuitive because of the formula of Gower metric for categorical traits
that is binary (see example below)</p>
<p><br></p>
<p>Applying PCoA to a non-Euclidean distance eventually leads to PC axes
with negative eigenvalues. Those axes are meaningless and removed by
default by the <code><a href="https://rdrr.io/pkg/ape/man/pcoa.html" class="external-link">ape::pcoa()</a></code> function used in the
<code><a href="../reference/quality.fspaces.html">mFD::quality.fspaces()</a></code> function.</p>
<p><br></p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># retrieve eigen values: </span></span>
<span><span class="va">quality_fspaces_fruits</span><span class="op">$</span><span class="st">"details_fspaces"</span><span class="op">$</span><span class="st">"pc_eigenvalues"</span></span></code></pre></div>
<pre><code><span><span class="co">##   Eigenvalues Relative_eig Rel_corr_eig Broken_stick Cum_corr_eig</span></span>
<span><span class="co">## 1 1.183979604  0.523773886   0.20462637   0.16236050    0.2046264</span></span>
<span><span class="co">## 2 0.679633661  0.300659202   0.12921016   0.11888224    0.3338365</span></span>
<span><span class="co">## 3 0.387668534  0.171498439   0.08555182   0.09714311    0.4193883</span></span>
<span><span class="co">## 4 0.286083089  0.126558642   0.07036147   0.08265036    0.4897498</span></span>
<span><span class="co">## 5 0.199866442  0.088417759   0.05746926   0.07178079    0.5472191</span></span>
<span><span class="co">## 6 0.067863730  0.030021843   0.03773054   0.06308514    0.5849496</span></span>
<span><span class="co">## 7 0.040732146  0.018019258   0.03367348   0.05583876    0.6186231</span></span>
<span><span class="co">## 8 0.037504259  0.016591292   0.03319080   0.04962758    0.6518139</span></span>
<span><span class="co">## 9 0.008765524  0.003877729   0.02889342   0.04419280    0.6807073</span></span>
<span><span class="co">##   Cumul_br_stick</span></span>
<span><span class="co">## 1      0.1623605</span></span>
<span><span class="co">## 2      0.2812427</span></span>
<span><span class="co">## 3      0.3783858</span></span>
<span><span class="co">## 4      0.4610362</span></span>
<span><span class="co">## 5      0.5328170</span></span>
<span><span class="co">## 6      0.5959021</span></span>
<span><span class="co">## 7      0.6517409</span></span>
<span><span class="co">## 8      0.7013685</span></span>
<span><span class="co">## 9      0.7455613</span></span></code></pre>
<p><br></p>
<p>Here, PCoA on the 25 fruits species described with 5 traits produced
9 PC axes with positive eigenvalues.</p>
<p><br></p>
<p>To deal with the non-Euclidean ‘issue’, it <strong>has been
recommended to square-root the Gower distance matrix before computing
the PCoA</strong>. However as Gower distance is by definition between 0
and 1, and as for 0 &lt; x &lt; 1, sqrt(x) &gt; x: <strong>this
transformation means that all square-root distances are higher than raw
distances and the difference between raw and square-root distances
varies non-linearly with raw distances</strong>.</p>
<p><br></p>
<p>If we look at raw and square-rooted Gower distance between blackberry
and 3 other species:</p>
<p><br></p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">quality_fspaces_fruits</span><span class="op">$</span><span class="st">"details_fspaces"</span><span class="op">$</span><span class="st">"pairsp_fspaces_dist"</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">sp.x</span>, <span class="va">sp.y</span>, Gower <span class="op">=</span> <span class="va">tr</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>sqrt_Gower <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">Gower</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">sp.x</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">ex_blackberry</span> <span class="op">&amp;</span> <span class="va">sp.y</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">ex_blackberry</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">across</a></span><span class="op">(</span><span class="fu">where</span><span class="op">(</span><span class="va">is.numeric</span><span class="op">)</span>, <span class="va">round</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##         sp.x       sp.y Gower sqrt_Gower</span></span>
<span><span class="co">## 1    currant     banana  0.77       0.88</span></span>
<span><span class="co">## 2 blackberry     banana  0.75       0.87</span></span>
<span><span class="co">## 3     cherry     banana  0.56       0.75</span></span>
<span><span class="co">## 4 blackberry    currant  0.08       0.29</span></span>
<span><span class="co">## 5     cherry    currant  0.42       0.65</span></span>
<span><span class="co">## 6     cherry blackberry  0.41       0.64</span></span></code></pre>
<p><br></p>
<p>Raw Gower distance between blackberry and banana is almost twice
higher than distance between blackberry and cherry and 10 times higher
than distance between blackberry and currant. Square-root distance
between blackberry and banana differs by a 1.5 and 3-fold factor to
distance between blackberry and cherry and currant, respectively because
of the high slope of the square-root function (close to 0).</p>
<p>If we apply <code>mFD::quality.fspace()</code> on the square-root of
Gower distance:</p>
<p><br></p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># compute quality metrics with square-root transformed distances:</span></span>
<span><span class="va">quality_fspaces_fruits_sqrtgower</span> <span class="op">&lt;-</span> <span class="fu">mFD</span><span class="fu">::</span><span class="fu"><a href="../reference/quality.fspaces.html">quality.fspaces</a></span><span class="op">(</span></span>
<span>  sp_dist             <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">dist_fruits</span><span class="op">)</span>,</span>
<span>  fdendro             <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  maxdim_pcoa         <span class="op">=</span> <span class="fl">24</span>,</span>
<span>  deviation_weighting <span class="op">=</span> <span class="st">"absolute"</span>,</span>
<span>  fdist_scaling       <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># check if distance matrix checks Euclidean properties:</span></span>
<span><span class="va">quality_fspaces_fruits_sqrtgower</span><span class="op">$</span><span class="st">"details_trdist"</span><span class="op">$</span><span class="st">"trdist_euclidean"</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] TRUE</span></span></code></pre>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># input distance is now Euclidean</span></span>
<span></span>
<span><span class="co"># get mean Absolute Deviation:</span></span>
<span><span class="va">quality_fspaces_fruits_sqrtgower</span><span class="op">$</span><span class="st">"quality_fspaces"</span></span></code></pre></div>
<pre><code><span><span class="co">##                   mad</span></span>
<span><span class="co">## pcoa_1d  3.382981e-01</span></span>
<span><span class="co">## pcoa_2d  2.226087e-01</span></span>
<span><span class="co">## pcoa_3d  1.564459e-01</span></span>
<span><span class="co">## pcoa_4d  1.085341e-01</span></span>
<span><span class="co">## pcoa_5d  7.532491e-02</span></span>
<span><span class="co">## pcoa_6d  5.672018e-02</span></span>
<span><span class="co">## pcoa_7d  4.145955e-02</span></span>
<span><span class="co">## pcoa_8d  3.047546e-02</span></span>
<span><span class="co">## pcoa_9d  2.150431e-02</span></span>
<span><span class="co">## pcoa_10d 1.574287e-02</span></span>
<span><span class="co">## pcoa_11d 1.110328e-02</span></span>
<span><span class="co">## pcoa_12d 7.616664e-03</span></span>
<span><span class="co">## pcoa_13d 5.610727e-03</span></span>
<span><span class="co">## pcoa_14d 3.892704e-03</span></span>
<span><span class="co">## pcoa_15d 2.938207e-03</span></span>
<span><span class="co">## pcoa_16d 2.079826e-03</span></span>
<span><span class="co">## pcoa_17d 1.567759e-03</span></span>
<span><span class="co">## pcoa_18d 1.246871e-03</span></span>
<span><span class="co">## pcoa_19d 8.976639e-04</span></span>
<span><span class="co">## pcoa_20d 6.126478e-04</span></span>
<span><span class="co">## pcoa_21d 3.900362e-04</span></span>
<span><span class="co">## pcoa_22d 2.266322e-04</span></span>
<span><span class="co">## pcoa_23d 7.579458e-05</span></span>
<span><span class="co">## pcoa_24d 4.140438e-16</span></span></code></pre>
<p><br></p>
<p>The inaccuracy (measured with <em>mAD</em> (mean absolute deviation)
metric) decreases with the number of axes down to 0.</p>
<p><br></p>
<p>But do not forget that the input used here is the square-root of
Gower distance. So let’s compare deviation between trait-based Gower
distance and Euclidean distance in the 24D PCoA space:</p>
<p><br></p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">quality_fspaces_fruits</span><span class="op">$</span><span class="st">"details_fspaces"</span><span class="op">$</span><span class="st">"pairsp_fspaces_dist"</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">sp.x</span>, <span class="va">sp.y</span>, Gower_distance <span class="op">=</span> <span class="va">tr</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Eucli_dist_24D_sqrt <span class="op">=</span> <span class="va">quality_fspaces_fruits_sqrtgower</span><span class="op">$</span><span class="st">"details_fspaces"</span><span class="op">$</span><span class="st">"pairsp_fspaces_dist"</span><span class="op">$</span><span class="st">"pcoa_24d"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Gower_distance</span>, y <span class="op">=</span> <span class="va">Eucli_dist_24D_sqrt</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_abline</a></span><span class="op">(</span>slope <span class="op">=</span> <span class="fl">1</span>, intercept <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="Compute_and_interpret_quality_of_functional_spaces_files/figure-html/unnamed-chunk-18-1.png" width="1152" style="display: block; margin: auto;"></p>
<p><br></p>
<p>As expected, the ranking of distances is ‘perfectly’ kept but with a
square-root shape above the 1:1 line.</p>
<p><br></p>
<p>If we now compute the actual <em>mAD</em> between Gower and Euclidean
distances in this apparently perfect 24D space:</p>
<p><br></p>
<pre><code><span><span class="co">## [1] 0.215148</span></span></code></pre>
<p><br></p>
<p>We notice that mAD = 0.212: inaccuracy is much higher than the worst
space and of the dendrogram computed on the raw Gower distance matrix
that does represent the actual difference in trait values</p>
<p><br></p>
<p>So to <strong>sum up</strong>:</p>
<ul>
<li>non-continuous traits ofteh make Gower distances between species
being non-Euclidean</li>
<li>PCoA on such Gower distance could lead to PCoA axes with negative
eigenvalues but the remaining axes always represent accurately Gower
distance (for more details see <a href="https://onlinelibrary.wiley.com/doi/full/10.1111/geb.12299" class="external-link">Maire
<em>et al.</em> (2015)</a> and especially <em>Figure 2</em>).</li>
<li>Square-root transformed Gower distance is apparently increasing the
efficiency of the PCoA (no more negative eigenvalue) but Euclidean
distance in this space are square-root biased representation of
trait-based distances that are the key features to account for when
computing FD</li>
</ul>
<p><br></p>
<p><strong><em>NOTE:</em></strong></p>
<p>If you are not convinced about Gower being both intuitive but
non-Euclidean consider the following simple case of 8 species described
with 3 categorical traits (2 modalities each), so there are 8 unique
combinations of trait values and the 28 species pairs are sharing 0, 1,
or 2 trait values:</p>
<p><br></p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># create a new dataset:</span></span>
<span><span class="va">sp_tr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  tra <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">LETTERS</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>, <span class="va">LETTERS</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>, <span class="va">LETTERS</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>, <span class="va">LETTERS</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  trb <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"M"</span>, <span class="fl">4</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"N"</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> ,</span>
<span>  trc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"X"</span>, <span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Y"</span>, <span class="fl">4</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"X"</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/row.names.html" class="external-link">row.names</a></span><span class="op">(</span><span class="va">sp_tr</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"sp"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">8</span><span class="op">)</span></span>
<span><span class="va">sp_tr</span></span></code></pre></div>
<pre><code><span><span class="co">##     tra trb trc</span></span>
<span><span class="co">## sp1   A   M   X</span></span>
<span><span class="co">## sp2   B   M   X</span></span>
<span><span class="co">## sp3   A   M   Y</span></span>
<span><span class="co">## sp4   B   M   Y</span></span>
<span><span class="co">## sp5   A   N   Y</span></span>
<span><span class="co">## sp6   B   N   Y</span></span>
<span><span class="co">## sp7   A   N   X</span></span>
<span><span class="co">## sp8   B   N   X</span></span></code></pre>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># compute Gower distance between all pairs of species:</span></span>
<span><span class="va">dist_gower</span> <span class="op">&lt;-</span> <span class="fu">cluster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/cluster/man/daisy.html" class="external-link">daisy</a></span><span class="op">(</span><span class="va">sp_tr</span>, metric <span class="op">=</span> <span class="st">"gower"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">dist_gower</span>, <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Dissimilarities :</span></span>
<span><span class="co">##      sp1  sp2  sp3  sp4  sp5  sp6  sp7</span></span>
<span><span class="co">## sp2 0.33                              </span></span>
<span><span class="co">## sp3 0.33 0.67                         </span></span>
<span><span class="co">## sp4 0.67 0.33 0.33                    </span></span>
<span><span class="co">## sp5 0.67 1.00 0.33 0.67               </span></span>
<span><span class="co">## sp6 1.00 0.67 0.67 0.33 0.33          </span></span>
<span><span class="co">## sp7 0.33 0.67 0.67 1.00 0.33 0.67     </span></span>
<span><span class="co">## sp8 0.67 0.33 1.00 0.67 0.67 0.33 0.33</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Metric :  mixed ;  Types = N, N, N </span></span>
<span><span class="co">## Number of objects : 8</span></span></code></pre>
<p><br></p>
<p>There are thus only 3 distances values, 0.33, 0.67 or 1, depending on
the number of traits with the same values (0, 1 or 2)</p>
<p><br></p>
<pre><code><span><span class="co">## Dissimilarities :</span></span>
<span><span class="co">##      sp1  sp2  sp3  sp4  sp5  sp6  sp7</span></span>
<span><span class="co">## sp2 0.58                              </span></span>
<span><span class="co">## sp3 0.58 0.82                         </span></span>
<span><span class="co">## sp4 0.82 0.58 0.58                    </span></span>
<span><span class="co">## sp5 0.82 1.00 0.58 0.82               </span></span>
<span><span class="co">## sp6 1.00 0.82 0.82 0.58 0.58          </span></span>
<span><span class="co">## sp7 0.58 0.82 0.82 1.00 0.58 0.82     </span></span>
<span><span class="co">## sp8 0.82 0.58 1.00 0.82 0.82 0.58 0.58</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Metric :  mixed ;  Types = N, N, N </span></span>
<span><span class="co">## Number of objects : 8</span></span></code></pre>
<p><br></p>
<p>After applying the squareroot transformation, the (1/0.33) 3-fold
difference in Gower distance between pairs of species sharing no trait
value and pairs of species sharing 2 traits becomes (1/0.58) &lt; 2.
Thus, applying the square-root transformation to Gower distance
decreases the magnitude of variation in trait-based distance, by
increasing the distances between the most similar species</p>
<p><br></p>
</div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<ul>
<li>Maire <em>et al.</em> (2015) How many dimensions are needed to
accurately assess functional diversity? A pragmatic approach for
assessing the quality of functional spaces. <em>Global Ecology and
Biogeography</em>, <strong>24</strong>, 728-740.</li>
</ul>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Camille Magneville, Nicolas Loiseau, Camille Albouy, Nicolas Casajus, Thomas Claverie, Arthur Escalas, Fabien Leprieur, Eva Maire, David Mouillot, Sebastien Villeger.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
